\documentclass[
        oneside,      %%coloque  % no in\'icio desta linha para imprimir frente e verso 
        english			
%	french,				
%	spanish, 
%        portuguese			 
        ]{abntbibufjf}


\usepackage[T1]{fontenc}		
\usepackage[utf8]{inputenc}		%% Para converter automaticamente acentos como digitados normalmente no teclado. Mude utf8 para latin1 se precisar. 

\usepackage{lmodern} %no caso do modelo Latex, pode-se usar a fam\'ilia de fontes lmodern como aqui indicado, no lugar de Arial e Times New Roman.


\usepackage{lastpage}			
\usepackage{indentfirst}		
\usepackage{color}			
\usepackage{graphicx}			
\usepackage{microtype} 
\usepackage{hyperref}
\usepackage{xurl}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{multirow}
%% -----------------------------------------------------------------------------

%% Obs.: Alguns acentos foram omitidos.

\titulo{Desenvolvimento de um Analisador de Espectro Óptico de Baixo Custo para Faixa Visível} %% Colocar, dentro de chaves {}, o t\'itulo do trabalho. 
\subtitulo{Calibração Automatizada via Visão Computacional}  %% Colocar % no in\'icio desta linha se nao tiver subt\'itulo 
\autor{Jakson Almeida} %%Colocar, dentro de chaves {}, o nome completo do autor
\autorVirg{Almeida, Jakson} %%Colocar o sobrenome do autor, separado por v\'rgula, antes do restante do nome do autor. Ex.: Santos, Maria dos
\local{Juiz de Fora} %%Governador Valadares % N\~ao usar MG.
\data{2025} %%Colocar o ano da entrega. Por exemplo, 2019. N\~ao usar m\^es.
\orientador[Orientador:]{Alexandre Bessa dos Santos} %%Se precisar, troque [Orientador:] por [Orientadora:]
\coorientador[Coorientador:]{Felipe Barino} %% Colocar ``%'' no in\'icio desta linha se n\~ao tiver coorientador. Se precisar, troque por [Cooorientadora:]. 
\orientadorTitulo{Professor} %%Colocar, dentro de chaves {}, a titula\c{c}\~ao do(a) orientador(a). Por exemplo, Prof. Dr.
\coorientadorTitulo{Doutor} %%Colocar, dentro de chaves {}, a titula\c{c}\~ao do(a) cooorientador(a). 
\instituicao{Universidade Federal de Juiz de Fora}
\faculdade{Faculdade de Engenharia El\'etrica} %%Colocar, dentro de chaves {}, o nome da faculdade ou do instituto.
\programa{Engenharia El\'etrica} %%Colocar, dentro de chaves {}, o nome do curso. Por exemplo: Programa de P\'os\mbox{-Gra}dua\c{c}\~ao em Matem\'atica
\objeto{Trabalho de Conclus\~ao de Curso (gradua\c{c}\~ao)}  %%Tese (Doutorado)  %%%Trabalho de Conclus\~ao de Curso (gradua\c{c}\~ao)
\natureza{Trabalho de conclus\~ao de curso apresentado \'a \inserefaculdade da   %% %%%Trabalho de conclus\~ao de curso apresentado \'a \inserefaculdade da %%%%SUBSTITUIR \'a POR ao SE FOR INSTITUTO    
Universidade Federal de Juiz de Fora como requisito parcial \`a obten\c{c}\~ao do 
grau de bacharel em  %%Doutor em    %%%grau de bacharel em 
Engenharia Elétrica. %%Trocar Matem\'atica por outro, se precisar.
}

%% Abaixo, prencher com os dados da parte final da ficha catalografica
\finalcatalog{1. Analisador de espectro óptico. 2. Calibração automatizada. 3. Visão computacional. 4. Espectro visível. I. Sobrenome, Nome do orientador, orient. II. T\'itulo.} %% Aqui fica 
% escrito a palavra ``T\'itulo'' mesmo, nao o do trabalho. Se tiver coorientador, os dados ficam depois dos dados 
%% do orientador (II. Sobrenome, Nome do coorientador, coorient.) e antes de ``II. T\'itulo'', o qual passa a ``III. T\'itulo''.


\usepackage[round, numbers]{natbib} %para refer\^encias bibliogr\'aficas no sistema num\'erico com () na chamada da citacao. 

%Se for usar o sistema autor-data, colocar % antes de \usepackage acima e retirar % antes de \usepackage abaixo.

%\usepackage{natbib} %para o sistema autor-data

% Numeração de figuras e tabelas em português (documento em PT-BR)
\renewcommand{\figurename}{Figura}
\renewcommand{\tablename}{Tabela}

% Remove negrito do título na capa e folha de rosto
\makeatletter
\renewcommand{\inserecapa}{
  \begin{capa}
   \begin{center}
    {
    \bfseries \MakeUppercase{\insereinstituicao} \par \MakeUppercase{\inserefaculdade} \par \MakeUppercase{\insereprograma}}
    \vfill
    {
    \bfseries \insereautor}
    \vfill
    {\normalfont \inseretitulo \IfNonempty{\inseresubtitulo}{: \inseresubtitulo}}
    \vfill
    \inserelocal \par \inseredata 
   \end{center}
   \end{capa}
}

\renewcommand{\folhaderostocont}{
  \begin{center}
    {
    \bfseries \insereautor} 
    \vspace*{\fill}
    \begin{center}
      {
      \normalfont \inseretitulo 
        \IfNonempty{\inseresubtitulo}{: \inseresubtitulo}}
    \end{center}
    \vspace*{\fill}
      \IfNonempty{\inserenatureza}{
      \hspace{.45\textwidth}
      \begin{minipage}{.5\textwidth}
      	\SingleSpacing
         \inserenatureza
      \end{minipage}
       \vspace*{\fill}
    }
  \end{center} 
   {\insereorientadorOU ~\insereorientadorTitulo ~\insereorientador \par }
    \IfNonempty{\inserecoorientador}{
       {\inserecoorientadorOU ~\inserecoorientadorTitulo ~\inserecoorientador}
    }
    \vfill
  \begin{center}  
    \inserelocal \par \inseredata   
  \end{center}
}
\makeatother

\begin{document}

%% ELEMENTOS PR\'E-TEXTUAIS


%% Capa. N\~ao entra na contagem da pagina\c{c}\~ao.
\inserecapa

%% Folha de rosto
\inserefolhaderosto

%% Ficha catalogr\'afica. AO IMPRIMIR, DEIXAR NO VERSO DA FOLHA DE ROSTO.
\inserecatalog  


%% Folha de aprovacao. Incluir mesmo que sem assinaturas. Assinaturas eletr\^onicas via SEI.
\begin{folhadeaprovacao}
\inicfolhaaprov
        
Aprovada em 6 de fevereiro de 2026 %%Preencher com a data 
   
\vfill
\begin{center} BANCA EXAMINADORA \end{center}
\assinatura{\insereorientadorTitulo~\insereorientador \ - Orientador \\ Universidade Federal de Juiz de Fora}  %%Orientadora
%\assinatura{Professor Dr. \inserecoorientador \ - Coorientador \\ Universidade Federal de Juiz de Fora}
\assinatura{Doutor Felipe Barino - Banca \\ Universidade Federal de Juiz de Fora}
\assinatura{Professor André Luiz Marques Marcato - Banca \\ Universidade Federal de Juiz de Fora} 
%\assinatura{...} %%RETIRE O % E PREENCHA SE PRECISAR
%  \assinatura{...}
%  \assinatura{...}
\end{folhadeaprovacao}
\cleardoublepage 


%% Dedicatoria. OPCIONAL. N\~ao deve haver t\'itulo. Colocar ``%'' no in\'icio de cada das 3 linhas abaixo, caso n\~ao queira. 
 \begin{dedicatoria} 
  Dedico este trabalho à minha família, que me apoiou em todos os passos desta jornada, e a todos que contribuíram para minha formação.
 \end{dedicatoria}

 
%% Agradecimentos. OPCIONAL. Caso seja bolsista, inserir os devidos agradecimentos.
\begin{agradecimentos}
Agrade\c{c}o aos meus pais e irm\~aos por todo o apoio durante esses anos de estudos longe de casa. Seu amor e incentivo foram fundamentais para que eu pudesse trilhar este caminho.

Agrade\c{c}o ao Professor Andr\'e Luiz Marques Marcato por ter me introduzido \`a Inicia\c{c}\~ao Cient\'ifica. Durante os quatro anos em que trabalhamos juntos, aprendi ROS, simula\c{c}\~ao de drones e vis\~ao computacional --- \'areas diretamente relacionadas \`a minha forma\c{c}\~ao em Engenharia El\'etrica com habilita\c{c}\~ao em Rob\'otica e Automa\c{c}\~ao Industrial.

Agrade\c{c}o em especial ao Professor Alexandre Bessa dos Santos, orientador deste trabalho, com quem atuei nos \'ultimos dois anos na \'area de instrumenta\c{c}\~ao \'optica. O presente trabalho d\'a continuidade a uma Inicia\c{c}\~ao Cient\'ifica desenvolvida em seu laborat\'orio.

Agrade\c{c}o ao coorientador Felipe Barino, que tamb\'em integra o LITel e me apresentou ao projeto OSA Visível que deu origem a este TCC, compartilhando seu conhecimento e dedicando tempo para me acompanhar neste percurso.

Por fim, agrade\c{c}o a tantos outros professores e colegas que, de diversas formas, contribu\'iram para a minha forma\c{c}\~ao acad\^emica. S\~ao muitas pessoas que merecem meu reconhecimento; opto por n\~ao nominar individualmente para n\~ao correr o risco de omitir algu\'em. A todos, meu sincero agradecimento.
\end{agradecimentos}


%% Ep\'igrafe. OPCIONAL. Com os dados do autor. A obra usada na ep\'igrafe deve constar nas refer\^encias. 

% Quando at\'e 3 linhas: \'e obrigat\'orio o uso de aspas duplas.

%\begin{epigrafemenos} %%Ep\'igrafe com 3 ou menos linhas
%``Mas para que o produto de uma pesquisa científica possa ser publicado não basta que ele apresente um conteúdo de qualidade, também é exigida qualidade de forma.'' (MAR\c{C}AL JUNIOR, 2013, p. 19-20).
%\end{epigrafemenos}

%%Quando com mais de 3 linhas. 

% \begin{epigrafemais} %%Ep\'igrafe com mais de 3 linhas 
% 	Elemento opcional, em que o autor apresenta uma cita\c{c}\~ao, seguida de indica\c{c}\~ao de autoria, relacionada com a                       
%   mat\'eria tratada no corpo do trabalho. (Associa\c{c}\~ao Brasileira de Normas T\'ecnicas, 2011, p. 2).
% \end{epigrafemais}


%% RESUMOS

%% Resumo em Portugu\^es. OBRIGAT\'ORIO. \'E obrigat\'orio o uso de par\'agrafo \'unico.
\begin{resumo}

Este trabalho apresenta o desenvolvimento de um Analisador de Espectro Óptico (OSA) de baixo custo para a faixa visível (380--750 nm), combinando o espectrômetro OSA Visível (impresso em 3D) e a interface OSA Visível (software customizado). A calibração abrange duas dimensões metrológicas: (i) o eixo de comprimento de onda, por técnicas de visão computacional que mapeiam a relação pixel--$\lambda$ com luz branca e lasers de referência (532 nm e 650 nm), incluindo cálculo de centróide, limiarização e regressão linear via OpenCV e Pillow; e (ii) o eixo de intensidade, mediante comparação com o espectrômetro ThorLabs (CCT11) e modelagem polinomial dos canais RGB para capturar o comportamento de saturação do sensor CMOS. A validação experimental demonstrou incertezas expandidas entre $\pm$0,13 nm e $\pm$0,29 nm (100 amostras temporais) e concordância com o espectrômetro ThorLabs, com diferenças inferiores a 3 nm para os picos verde e vermelho. O modelo de combinação de canais alcança $R^2 = 0{,}9999$ na predição da intensidade. Os experimentos incluem repetibilidade temporal, comparação em $\lambda$ e caracterização de intensidade com fonte PWM. Ao reduzir custos de mais de \$30.000 (OSA comercial) para menos de \$200, esta solução democratiza a análise espectral para aplicações educacionais e de pesquisa. \\[18pt]
Palavras-chave: analisador de espectro óptico; calibração automatizada; visão computacional; espectro visível; calibração de intensidade; espectrômetro ThorLabs. %Separadas por ``;'' e iniciadas por letras min\'usculas.
\end{resumo}
 
 
%% Resumo em Ingl\^es. \'E obrigat\'orio o uso de par\'agrafo \'unico.
\begin{resumo}[ABSTRACT]
 \begin{otherlanguage*}{english}

This work presents the development of a low-cost Optical Spectrum Analyzer (OSA) for visible light spectra (380--750 nm), combining the OSA Visível spectrometer (3D-printed) and the OSA Visível interface (custom software). Calibration addresses two metrological dimensions: (i) the wavelength axis, through computer vision techniques that map the pixel--$\lambda$ relationship using white light and reference lasers (532 nm and 650 nm), including centroid calculation, thresholding, and linear regression via OpenCV and Pillow; and (ii) the intensity axis, by comparison with a ThorLabs spectrometer (CCT11) and polynomial modeling of RGB channels to capture the CMOS sensor saturation behavior. Experimental validation yielded expanded uncertainties between $\pm$0.13 nm and $\pm$0.29 nm (100 temporal samples) and agreement with the ThorLabs spectrometer, with differences under 3 nm for the green and red peaks. The channel combination model reaches $R^2 = 0{,}9999$ for intensity prediction. The experiments encompass temporal repeatability, wavelength comparison, and intensity characterization with a PWM-controlled source. By reducing costs from over \$30,000 (commercial OSA) to under \$200, this solution democratizes spectral analysis for educational and research applications. \\[18pt]
Keywords: optical spectrum analyzer; automated calibration; computer vision; visible spectrum; intensity calibration; ThorLabs spectrometer. %Separadas por ``;'' e iniciadas por letras min\'usculas.
 \end{otherlanguage*}
\end{resumo}

%% Seguindo o mesmo modelo acima, pode-se inserir resumos em outras l\'inguas. 



%% Lista de ilustra\c{c}\~oes. OPCIONAL. Sao consideradas ilustra\c{c}\~oes: desenhos, esquemas, fluxogramas, figuras, fotografias, gr\'aficos, mapas, organogramas, plantas, quadros, entre outros. Tabelas n\~ao s\~ao consideradas ilustra\c{c}\~oes. A ordem da lista deve obrigatoriamente ser a mesma ordem em que as ilustra\c{c}\~oes aparecem no texto. Quando o t\'itulo ocupar mais de uma linha, a segunda linha deve estar exatamente abaixo da primeira.  

\pdfbookmark[0]{\listfigurename}{lof}

%Caso as ilustra\c{c}~oes do trabalho sejam todas do mesmo tipo (por exemplo, todas do tipo organograma), coloque % no in\'icio das duas linhas abaixo. 
%\ilustvaria   %Use este comando somente caso as ilustra\c{c}\~oes n\~ao sejam todas do mesmo tipo. 
%\listilustvaria  %Use este comando somente caso as ilustra\c{c}\~oes n\~ao sejam todas do mesmo tipo e caso queira inserir a lista delas. 

\listoffigures*  %Numera\c{c}\~ao ``Figura 1'', ``Figura 2'' etc. nas legendas e na lista.

\cleardoublepage
\pdfbookmark[0]{\listtablename}{lot}

%% Lista de tabelas. OPCIONAL. A ordem da lista de tabelas deve obrigatoriamente ser a mesma ordem em que as tabelas aparecem no texto. 


\listoftables*    %Coloque ``%'' no in\'icio desta linha, caso n\~ao queira lista de tabelas. 

\cleardoublepage


%% Lista de abreviaturas e siglas. OPCIONAL. Nao deve haver sinal grafico entre as siglas e abreviaturas e o significado. 

\begin{siglas} %%ALTERAR OS EXEMPLOS ABAIXO, CONFORME A NECESSIDADE
  \item[ADC] Analog-to-Digital Converter (Conversor Analógico-Digital)
  \item[CMOS] Complementary Metal-Oxide-Semiconductor (Semicondutor de Óxido Metálico Complementar)
  \item[COTS] Commercial Off-The-Shelf (Componentes Comerciais Prontos para Uso)
  \item[CRI] Color Rendering Index (Índice de Reprodução de Cor)
  \item[DWDM] Dense Wavelength Division Multiplexing (Multiplexação por Divisão de Comprimento de Onda Densa)
  \item[FBG] Fiber Bragg Grating (Rede de Bragg em Fibra)
  \item[FWHM] Full Width at Half Maximum (Largura Total à Meia Altura)
  \item[HCN] Cianeto de Hidrogênio (Hydrogen Cyanide)
  \item[IEC] International Electrotechnical Commission (Comissão Eletrotécnica Internacional)
  \item[LITel] Laboratório de Instrumentação e Telemetria
  \item[LPG] Long-Period Grating (Rede de Longo Período)
  \item[MAE] Mean Absolute Error (Erro Absoluto Médio)
  \item[OSA] Optical Spectrum Analyzer (Analisador de Espectro Óptico)
  \item[OSNR] Optical Signal-to-Noise Ratio (Relação Sinal-Ruído Óptico)
  \item[POC] Point-of-Care (Ponto de Cuidado)
  \item[PWM] Pulse Width Modulation (Modulação por Largura de Pulso)
  \item[RGB] Red, Green, Blue (Vermelho, Verde, Azul)
  \item[RMS] Root Mean Square (Raiz Quadrada da Média dos Quadrados)
  \item[RMSE] Root Mean Square Error (Erro Quadrático Médio)
  \item[ROI] Region of Interest (Região de Interesse)
  \item[SNR] Signal-to-Noise Ratio (Relação Sinal-Ruído)
  \item[UFJF] Universidade Federal de Juiz de Fora
  \item[USD] United States Dollar (Dólar Americano)
  \item[UV-Vis] Ultravioleta-Visível
  \item[VIS] Visível (faixa espectral)
  \end{siglas}

%% Lista de s\'imbolos. OPCIONAL. Nao deve haver sinal grafico entre o simbolo e o seu significado.

\begin{simbolos} %%ALTERAR OS EXEMPLOS ABAIXO, CONFORME A NECESSIDADE
  \item[$ \lambda $] Comprimento de onda
  \item[$ \lambda_0 $] Posição central do pico espectral
  \item[$ \lambda(x) $] Relação comprimento de onda--pixel
  \item[$ T $] Limiar ótimo de limiarização (método de Otsu)
  \item[$ I $] Intensidade (pixel ou espectral)
  \item[$ I_0 $] Intensidade máxima do pico (perfil Lorentziano)
  \item[$ I(x,y) $] Intensidade do pixel na posição (x,y)
  \item[$ \bar{I}(x,y) $] Intensidade média temporal
  \item[$ M(x,y) $] Máscara binária após limiarização
  \item[$ R^2 $] Coeficiente de determinação
  \item[$ n $] Ordem de difração
  \item[$ d $] Espaçamento da grade de difração
  \item[$ \theta $] Ângulo de difração
  \item[$ \alpha $] Ângulo de incidência
  \item[$ a, b $] Coeficientes da regressão linear $\lambda(x) = a \cdot x + b$
  \item[$ m, c $] Inclinação e intercepto da reta espectral ($y = m \cdot x + c$)
  \item[$ x_c, y_c $] Coordenadas do centróide
  \item[$ x_{peak} $] Posição do pico de intensidade
  \item[$ x $] Posição horizontal (pixel) ou duty cycle (\%)
  \item[$ N $] Número de quadros na média temporal
  \item[$ H $] Altura da imagem (pixels)
  \item[$ k $] Nível de intensidade digital (0--255)
  \item[$ \gamma $] Parâmetro de largura do perfil Lorentziano (FWHM $= 2\gamma$)
  \item[$ \sigma $] Desvio padrão do perfil Gaussiano
  \item[$ a_i, b_i, c_i $] Coeficientes do polinômio $f_i(x) = a_i x^2 + b_i x + c_i$ por canal
  \item[$ \alpha_i $] Coeficientes da combinação linear de canais (modelo intensidade)
 \end{simbolos}

 
%% Sum\'ario

\pdfbookmark[0]{\contentsname}{toc}
\tableofcontents*
\cleardoublepage

%% ----------------------------------------------------------

%% ELEMENTOS TEXTUAIS
\textual


\chapter{INTRODU\c{C}\~AO}  %%Nesta linha, dentro de { }, digita-se em CAIXA ALTA, como apresentado aqui

O Analisador de Espectro Óptico (OSA) é um instrumento metrológico cuja importância reside na sua capacidade de quantificar a distribuição de potência da radiação eletromagnética em função do comprimento de onda ($\lambda$). Tradicionalmente, o campo de estudo da espectrofotometria Ultravioleta-Visível (UV-Vis) abrange a região que vai de aproximadamente $190$ nm a $900$ nm \cite{agilent_uvvis}. Dentro deste intervalo, a faixa visível (VIS) é estritamente definida, compreendendo comprimentos de onda entre aproximadamente $400$ nm (violeta) e $700$ nm (vermelho).

Esta região espectral é particularmente crítica, pois as transições de energia atômicas e moleculares que ocorrem neste domínio são a base de diversas aplicações químicas, biológicas e de metrologia de cor. A radiação UV e VIS possui energia suficiente para induzir transições entre diferentes níveis de energia eletrônica em moléculas \cite{agilent_uvvis}. Quando a radiação eletromagnética interage com a matéria, diversos fenômenos podem ocorrer, incluindo reflexão, espalhamento, absorção, fluorescência/fosforescência e reações fotoquímicas \cite{agilent_uvvis}.

A relevância do OSA na faixa visível está intrinsecamente ligada à capacidade de quantificar a presença de compostos ou biomarcadores que exibem absorção seletiva nesta faixa. Por exemplo, a utilização da faixa visível (em especial o vermelho, $660$ nm) para diagnósticos, como na oximetria de pulso \cite{smartphone_spectroscopy}, não é acidental, mas sim uma consequência direta das diferenças de absorção espectral entre a hemoglobina oxigenada e a desoxigenada. Essa sensibilidade à composição química enfatiza a necessidade fundamental de calibração ultra-precisa do eixo de comprimento de onda ($\lambda$). Um desvio mínimo no mapeamento espectral pode resultar em erros significativos na medição da concentração, particularmente em regiões de alta inclinação do espectro de absorção.

Um Analisador de Espectro Óptico (OSA) é um instrumento de precisão projetado para medir e exibir a distribuição de \textbf{potência óptica} de uma fonte de luz sobre um determinado intervalo de comprimento de onda \cite{viavi_osa}. Os três parâmetros-chave quantificados por um OSA são o comprimento de onda, o nível de potência e a Relação Sinal-Ruído Óptico (\textit{Optical Signal-to-Noise Ratio} - OSNR) \cite{viavi_osa}. É crucial distinguir a funcionalidade de um OSA de um espectrofotômetro tradicional de bancada. O termo OSA é frequentemente empregado para medir a distribuição espectral de potência de uma fonte de luz (Potência vs. $\lambda$) \cite{viavi_osa}, sendo amplamente utilizado em telecomunicações para caracterizar lasers. No contexto da caracterização de sensores de fibra óptica, como \textit{Long-Period Gratings} (LPGs) e \textit{Fiber Bragg Gratings} (FBGs), o OSA atua como um \textbf{interrogador espectral}, medindo a atenuação ou o pico de reflexão \cite{fiber_sensor_characterization}.

Analisadores de Espectro Óptico comerciais que operam na faixa visível apresentam custos elevados, frequentemente superiores a \$30.000, conforme pesquisa realizada em março de 2025 \cite{thorlabs_osa20xc}. Isso restringe significativamente o acesso desses equipamentos para muitas instituições acadêmicas e laboratórios de pequeno porte, limitando o desenvolvimento de pesquisas e o ensino prático de espectroscopia. A necessidade de precisão na faixa visível é crítica, especialmente em medições ratiométricas como a oximetria de pulso, onde um erro mínimo na calibração do comprimento de onda (eixo $\lambda$) pode levar a erros diagnósticos significativos \cite{smartphone_spectroscopy}.

Como alternativa, o desenvolvimento de soluções de baixo custo tem ganhado destaque na literatura científica. O espectrômetro OSA Visível foi desenvolvido com uma abordagem inovadora, utilizando impressão 3D, uma webcam e uma grade de difração, totalizando menos de \$200 USD, tornando-o uma solução acessível para pesquisa e ensino.

Este trabalho propõe uma solução de baixo custo baseada no espectrômetro OSA Visível (hardware aberto) e na interface OSA Visível (software customizado), desenvolvido pelo Laboratório de Instrumentação e Telemetria (LITel/UFJF). O princípio fundamental é o mesmo dos OSAs tradicionais: a luz, após interagir com a amostra ou sensor, é dispersa (geralmente por uma grade de transmissão simples) e, em vez de atingir um detector de varredura ou um \textit{array} de fotodiodos especializado, é capturada pelo sensor CMOS \cite{smartphone_spectroscopy}. O sensor CMOS, que é um detector de intensidade, torna-se o principal \textit{array} de detecção espectral do sistema.

O diferencial deste trabalho reside no uso de técnicas de visão computacional para calibração automática, substituindo métodos manuais ou baseados em hardware dedicado. O desafio metrológico em sistemas de visão é duplo: converter dados de imagem (coordenada de pixel) em dados espectrais (comprimento de onda, $\lambda$) e assegurar que a intensidade registrada reflita corretamente a potência óptica incidente \cite{smartphone_spectroscopy}. O sensor CMOS, embora otimizado para o VIS ($400$ nm a $700$ nm) devido ao filtro infravermelho \cite{smartphone_spectroscopy}, captura a informação através de uma matriz de filtros Bayer (RGB). Isso significa que a medição não é puramente espectral, mas sim uma resposta de cor que deve ser desmembrada. O processo de dispersão óptica mapeia $\lambda$ para uma posição física no sensor ($p$). A relação entre $p$ e $\lambda$ não é trivialmente linear e é altamente suscetível a desalinhamentos físicos da grade de difração, à temperatura e a não-uniformidades na montagem.

A visão computacional é o motor que realiza a \textbf{conversão de pixel-para-wavelength} \cite{smartphone_spectroscopy}. Esta etapa é o cerne da calibração do eixo $\lambda$, transformando uma imagem de difração (dados de pixel RGB) em um espectro quantitativo (Intensidade vs. $\lambda$). A calibração desenvolvida neste trabalho combina duas etapas principais: (i) captura do espectro contínuo de luz branca, com detecção do centróide e ajuste inicial de uma reta via regressão linear; e (ii) correlação direta entre picos de intensidade de lasers (532 nm e 650 nm) e suas posições na imagem, definindo a relação comprimento de onda-posição de pixel. Já o eixo de intensidade (potência) é validado por meio da comparação com um espectrômetro de referência, permitindo modelar a resposta dos canais RGB do OSA Visível em função da irradiância incidente.

Ao contrário dos OSAs tradicionais, que garantem a precisão através de componentes ópticos e eletrônicos caros (monocromadores de alta qualidade, arquiteturas de feixe duplo) \cite{agilent_uvvis}, o método deste trabalho utiliza software (visão computacional) para compensar as deficiências inerentes ao hardware óptico de baixo custo. Essa abordagem representa uma \textbf{mudança de paradigma metrológico}, onde a garantia de precisão migra da engenharia óptica de \textit{hardware} para a engenharia algorítmica de \textit{software}. O algoritmo de calibração deve ser robusto o suficiente para realizar a compensação de instabilidade da fonte de luz e a correção de ruído via \textit{software}, replicando funções que os sistemas ópticos de alto custo executam em hardware \cite{agilent_uvvis}.

O objetivo geral deste trabalho é desenvolver um Analisador de Espectro Óptico de baixo custo para a faixa visível (400--700 nm), integrando hardware acessível e software customizado com calibração automatizada via visão computacional. A calibração do instrumento deve garantir a precisão nas duas dimensões metrológicas: a escala de \textbf{Wavelength (Eixo X)} e a escala de \textbf{Potência (Eixo Y)} \cite{viavi_osa}, replicando a funcionalidade de um OSA comercial.

Os objetivos específicos incluem:

\begin{itemize}
    \item Desenvolver o espectrômetro OSA Visível de baixo custo (impresso em 3D);
    \item Implementar a interface OSA Visível para análise espectral com interface intuitiva;
    \item Criar sistema de calibração automatizada utilizando técnicas de visão computacional que realize a conversão precisa de pixel-para-wavelength \cite{smartphone_spectroscopy};
    \item Validar a precisão do eixo $\lambda$ através de experimentos de repetibilidade temporal e comparação com espectrômetro ThorLabs (CCT11), utilizando uma fonte de luz RGB;
    \item Validar a calibração do eixo de intensidade mediante comparação com o espectrômetro ThorLabs e modelagem da relação entre os canais RGB do OSA Visível e as medições do equipamento de referência, utilizando uma fonte com controle de intensidade por PWM;
    \item Reduzir custos de mais de \$30.000 (OSA comercial) para menos de \$200;
    \item Alcançar precisão de calibração de $\pm$2 nm na faixa visível e incertezas expandidas compatíveis com aplicações educacionais e de pesquisa.
\end{itemize}

A metodologia adotada compreende o desenvolvimento de hardware baseado em impressão 3D, implementação de algoritmos de visão computacional em Python, calibração híbrida com luz branca e lasers de referência, e validação experimental em duas frentes complementares. Na primeira frente, uma \textbf{fonte de luz RGB} com picos espectrais característicos (azul, verde e vermelho) é utilizada para avaliar a repetibilidade temporal do OSA Visível e para comparar os comprimentos de onda medidos com os do espectrômetro ThorLabs. Na segunda frente, uma \textbf{fonte com controle PWM} (LEDs verde, vermelho e azul acionados individualmente, com duty cycle variável) permite caracterizar a resposta de intensidade de ambos os equipamentos e modelar a relação entre os canais RGB do OSA Visível e as medições do ThorLabs. As duas fontes são distintas e foram projetadas para atender aos requisitos específicos de cada validação; sua descrição detalhada encontra-se no Capítulo 3. Os métodos de calibração por visão envolvem: localização geométrica da linha de difração na imagem \cite{smartphone_spectroscopy}; mapeamento espectral com fontes de referência; e processamento de dados para extrair a curva intensidade vs. comprimento de onda \cite{smartphone_spectroscopy}.

A importância dos OSAs transcende o laboratório de pesquisa, estendendo-se a setores de alta tecnologia, saúde e manufatura. Nas telecomunicações, o OSA monitora a precisão do comprimento de onda para garantir que os canais estejam corretamente separados em redes DWDM \cite{viavi_osa}. Na caracterização de sensores de fibra óptica, como FBGs e LPGs, o OSA permite quantificar a sensibilidade com precisões da ordem de $0.037$ nm/kPa \cite{fbg_sensor}. Em aplicações biomédicas, como a oximetria de pulso, a precisão na faixa visível (especialmente em $660$ nm) é crítica para diagnósticos precisos \cite{smartphone_spectroscopy}. O desenvolvimento de um método de calibração por visão computacional habilita diretamente a transição industrial para dispositivos \textit{Point-of-Care} (POC) em ambientes com recursos limitados.

Este trabalho está organizado da seguinte forma: o Capítulo 2 apresenta a fundamentação teórica sobre espectroscopia óptica e analisadores de espectro; o Capítulo 3 detalha a metodologia de desenvolvimento do hardware e software, incluindo os algoritmos de visão computacional e a descrição dos experimentos de validação; o Capítulo 4 descreve os resultados experimentais, abrangendo repetibilidade temporal, comparação em comprimento de onda, caracterização de intensidade e modelagem por combinação de canais; e o Capítulo 5 apresenta as conclusões e trabalhos futuros.

\chapter{FUNDAMENTAÇÃO TEÓRICA}

Este capítulo apresenta a fundamentação teórica necessária para o desenvolvimento do Analisador de Espectro Óptico de baixo custo. Inicialmente, são apresentados os princípios de difração e dispersão, fundamentais para o funcionamento do espectrômetro. Posteriormente, são discutidos os Analisadores de Espectro Óptico, suas arquiteturas e métodos de calibração, com ênfase nas técnicas modernas e na calibração por visão computacional. Por fim, é apresentado o processo híbrido de calibração desenvolvido neste trabalho.

\section{FUNDAMENTOS DA ESPECTROSCOPIA ÓPTICA}

A espectroscopia óptica constitui o pilar fundamental para a caracterização da matéria, explorando a interação entre a radiação eletromagnética e as propriedades atômicas e moleculares de uma amostra. O Analisador de Espectro Óptico (OSA) de baixo custo, denominado OSA Visível (espectrômetro e interface), é projetado para operar na faixa de luz visível (VIS, 380-750 nm). Neste intervalo, a absorção de energia luminosa tipicamente desencadeia transições eletrônicas em moléculas ou íons, permitindo a identificação e quantificação de compostos químicos através de seus espectros característicos.

\subsection{\textbf{O Princípio da Difração de Fraunhofer e Grades Ópticas}}

A separação dos diferentes comprimentos de onda que incidem sobre o detector do OSA é realizada por um elemento dispersor, neste caso, uma grade de difração. A difração de Fraunhofer (também chamada de difração de campo distante) descreve o padrão de difração que ocorre quando as ondas planas incidem sobre o objeto dispersor e o padrão é observado a uma distância suficientemente longa ou no plano focal de uma lente de imagem, que é o arranjo típico de um espectrômetro \cite{fraunhofer_wiki}.

A relação fundamental que governa a dispersão angular de uma grade de difração é dada pela Equação da Grade:

\begin{equation}
n\lambda = d(\sin\theta + \sin\alpha)
\label{eq:diffraction}
\end{equation}

Nesta equação, $n$ representa a ordem de difração (geralmente $n=1$ é utilizado), $\lambda$ é o comprimento de onda da luz, $d$ é a constante da grade (espaçamento entre as linhas, $d = 1\,\mu\textrm{m}$ para a grade de $1000$ linhas/mm usada no espectrômetro OSA Visível), $\alpha$ é o ângulo de incidência da luz na grade, e $\theta$ é o ângulo de difração.

A relação entre o comprimento de onda ($\lambda$) e a posição física do pixel ($x$) no detector, resultante dessa dispersão, é inerentemente não linear, pois envolve funções trigonométricas de ângulo. No entanto, em sistemas compactos de baixo custo, como o espectrômetro OSA Visível, o detector captura apenas uma porção angular muito pequena do espectro. Esta limitação angular permite que o mapeamento seja modelado, em primeira aproximação, por uma \textbf{Regressão Linear} ($\lambda(x) = a \cdot x + b$) \cite{henriksen_calibration}. Reconhece-se que essa simplificação linear requer uma calibração rigorosa e absoluta, que é justamente fornecida pelos pontos de referência de lasers de comprimento de onda conhecido, como será detalhado nas seções subsequentes.

\section{ANALISADORES DE ESPECTRO ÓPTICO: ARQUITETURAS E METROLOGIA}

O Analisador de Espectro Óptico (OSA) é um instrumento essencial para medir a distribuição de potência óptica em função do comprimento de onda \cite{spectrum_analyzer_wiki}.

\subsection{\textbf{Definição e Arquitetura do espectrômetro OSA Visível}}

Historicamente, OSAs utilizavam arquiteturas baseadas em monocromadores sintonizáveis (varredura), onde um filtro óptico ajustável resolvia os componentes espectrais individualmente. Em contraste, o OSA Visível utiliza uma arquitetura baseada em \textit{array} de detectores (grade/CMOS), que captura todo o espectro simultaneamente, melhorando a velocidade de aquisição \cite{keysight_osa}.

O espectrômetro OSA Visível foi desenvolvido com base no projeto \textit{Open Fiber Spectrometer} \cite{gaudi_spectrometer}, um espectrômetro de código aberto que fornece modelos 3D e instruções detalhadas para construção. O projeto original foi adaptado para atender às necessidades específicas deste trabalho, com foco na faixa visível do espectro (380-750 nm). O uso da impressão 3D reduz drasticamente os custos e permite a personalização rápida do design, superando a necessidade de polimento de precisão laboriosa, comum em óptica tradicional \cite{stanford_3d_optics}.

Os componentes principais são:

\begin{itemize}
    \item \textbf{Estrutura Impressa em 3D:} Proporciona a geometria necessária para o caminho óptico, fenda, e posicionamento da grade e do sensor.
    \item \textbf{Grade de Difração:} Responsável por separar os comprimentos de onda, com $1000$ linhas/mm.
    \item \textbf{Detector:} Uma Webcam USB, utilizando um sensor CMOS de $640 \times 480$ pixels.
\end{itemize}

O sinal de luz, depois de disperso, é discretizado pelo sensor CMOS. A intensidade digital no pixel $(x,y)$ é representada pela equação de amostragem:

\begin{equation}
I(x,y) = \sum_{k=0}^{255} k \cdot P(k|x,y)
\label{eq:sampling}
\end{equation}

onde $k$ é o nível de intensidade (de 0 a 255) e $P(k|x,y)$ é a probabilidade do pixel $(x,y)$ registrar a intensidade $k$.

\subsection{\textbf{Metrologia de OSAs: Padrões e a Justificativa para a Solução de Baixo Custo}}

A calibração de OSAs de alta precisão é regida por normas internacionais, como a IEC 62129, que detalham procedimentos para garantir a rastreabilidade da medição de comprimento de onda e potência \cite{iec_62129}. Métodos tradicionais de calibração utilizados em equipamentos de laboratório envolvem:

\begin{enumerate}
    \item \textbf{Fontes de Referência Estáveis:} Uso de lasers altamente estabilizados, cujos comprimentos de onda são monitorados simultaneamente por um \textit{wavemeter} de altíssima acurácia. \cite{dubard1995} discutiram a necessidade de caracterizar com precisão as fontes ópticas em medições de fibras ópticas e apresentaram técnicas de calibração para OSAs \cite{terra_calibration}.
    \item \textbf{Células de Gás:} Utilização de células de referência (e.g., HCN) que fornecem picos de absorção fixos e bem conhecidos em faixas específicas \cite{terra_calibration}.
    \item \textbf{Modelagem Polinomial Avançada:} Empregando lâmpadas de arco (neon, argônio) para gerar múltiplos picos espectrais conhecidos, ajustados por polinômios de segunda ou terceira ordem para mapear a relação comprimento de onda-pixel. \cite{liu2013} empregam métodos de calibração precisos utilizando parâmetros do sistema para espectrômetros de grade \cite{henriksen_calibration}.
\end{enumerate}

O custo desses métodos e dos equipamentos comerciais é proibitivo, variando de mais de \$30.000 a mais de \$100.000 para modelos de alta performance. Diante dessa realidade, o sistema OSA Visível representa uma abordagem estratégica para democratizar a análise espectral. A substituição da instrumentação metrológica de ponta pela \textbf{inteligência algorítmica} (visão computacional) permite alcançar acurácia adequada a um custo total inferior a \$200, justificando a inovação do processo de calibração automatizada.

A Tabela \ref{tab:comparativo_osa} apresenta um comparativo entre OSAs comerciais e o OSA Visível desenvolvido neste trabalho.

\begin{table}[ht]
\centering
\caption{Comparativo de Requisitos Metrológicos: OSA Comercial vs. OSA Visível}
\label{tab:comparativo_osa}
\begin{tabular}{>{\raggedright\arraybackslash}p{3cm}>{\centering\arraybackslash}p{2cm}>{\centering\arraybackslash}p{2.5cm}>{\centering\arraybackslash}p{2cm}>{\raggedright\arraybackslash}p{3cm}}
\hline
Modelo (Referência) & Faixa Espectral (nm) & Custo Estimado (USD) & Acurácia Típica & Método de Calibração \\
\hline
OSA201C \cite{thorlabs_osa20xc} & 350-1100 & > \$30.000 & Sub-nm & Interno, Rastreado a Padrões \\
CCT11 \cite{thorlabs_cct11} & 350-700 & \$3.000-6.000 & $<$ 0,5 nm & Referência nos experimentos \\
AQ6380 \cite{yokogawa_aq6374} & 350-1750 & \$100.000-200.000 & Sub-pm & Padrões de Gás/Wavemeter \cite{terra_calibration} \\
\textbf{espectrômetro OSA Visível} & \textbf{380-750} & \textbf{< \$200} & \textbf{Incerteza exp. $<$ 0,3 nm} & \textbf{Híbrido (Visão Computacional + Laser)} \\
\hline
\end{tabular}
\fonte{Elaborada pelo autor (2025).}
\end{table}

\section{FUNDAMENTAÇÃO DO MAPEAMENTO COMPRIMENTO DE ONDA-PIXEL}

A calibração de comprimento de onda, ou calibração espectral, é o processo crucial que estabelece a correspondência exata entre o índice de pixel no sensor CMOS (coordenada $x$) e o valor absoluto do comprimento de onda ($\lambda$).

\subsection{\textbf{O Desafio da Relação $\lambda(x)$: Dispersão Física e Distorções do Sistema}}

A transformação do ângulo de difração ($\theta$) em posição de pixel ($x$) é influenciada pela geometria do sistema e pelas imperfeições do hardware. Em espectrômetros construídos com peças COTS (\textit{Commercial Off-The-Shelf}) e impressão 3D, existem fontes de erro que desviam a relação $\lambda(x)$ do ideal, como desalinhamentos angulares da grade, curvatura de campo do sensor e tolerâncias mecânicas na montagem.

\subsection{\textbf{A Modelagem de Primeira Ordem: Regressão Linear ($\lambda(x) = a \cdot x + b$)}}

Para simplificar o processamento e, dado que o OSA Visível opera em uma faixa espectral relativamente estreita (380-750 nm), o mapeamento é modelado com um ajuste de primeira ordem \cite{henriksen_calibration}. A relação linear entre o pixel e o comprimento de onda é definida por:

\begin{equation}
\lambda(x) = a \cdot x + b
\label{eq:lambda_pixel}
\end{equation}

onde $a$ é o fator de dispersão (nm/pixel) e $b$ é o \textit{offset} de comprimento de onda.

O método de calibração do OSA Visível utiliza o princípio de Mínimos Quadrados (\textit{Least Squares}) para determinar $a$ e $b$, mas com uma ênfase particular na calibração por pontos fixos. Os lasers de referência Verde ($\lambda_{\textrm{verd}} = 532$ nm) e Vermelho ($\lambda_{\textrm{verm}} = 650$ nm) fornecem dois pontos metrológicos de ancoragem absoluta.

Os coeficientes $a$ e $b$ são calculados diretamente a partir da posição dos picos de intensidade desses lasers ($x_{\textrm{verd}}$ e $x_{\textrm{verm}}$):

\begin{equation}
a = \frac{\lambda_{\textrm{verm}} - \lambda_{\textrm{verd}}}{x_{\textrm{verm}} - x_{\textrm{verd}}}, \quad b = \lambda_{\textrm{verd}} - a \cdot x_{\textrm{verd}}
\label{eq:coeficientes}
\end{equation}

Utilizar dois pontos fixos é fundamental. Um único ponto definiria apenas o \textit{offset} $b$, mas deixaria a taxa de dispersão $a$ (nm/pixel) sujeita a erros sistêmicos. A determinação de ambos os parâmetros por dois pontos de referência garante que o escalonamento da dispersão angular seja corretamente aplicado em toda a faixa de operação do espectrômetro, minimizando o erro de inclinação.

\subsection{\textbf{Metrologia de Acurácia: O Conceito de Erro RMS}}

A acurácia do mapeamento comprimento de onda-pixel é avaliada utilizando o Erro Quadrático Médio (\textit{Root Mean Square Error} - RMS), uma métrica padrão na metrologia espectral que quantifica a magnitude média do erro entre os valores medidos e os valores de referência \cite{henriksen_calibration}.

O processo híbrido de calibração demonstra melhoria de precisão em relação ao ajuste preliminar: a ancoragem com lasers de referência refine os parâmetros e reduz o erro residual. A validação experimental (Capítulo 4) reporta incertezas expandidas e concordância com espectrômetro de referência.

A Tabela \ref{tab:parametros_calibracao} apresenta os parâmetros chave da calibração linear do OSA Visível.

\begin{table}[ht]
\centering
\caption{Parâmetros Chave da Calibração Linear do OSA Visível}
\label{tab:parametros_calibracao}
\begin{tabular}{>{\raggedright\arraybackslash}p{3.5cm}>{\centering\arraybackslash}p{3cm}>{\centering\arraybackslash}p{3cm}>{\raggedright\arraybackslash}p{3.5cm}}
\hline
Parâmetro Metrológico & Ajuste Preliminar (Luz Branca) & Ajuste Final (Lasers 532/650 nm) & Significado Físico \\
\hline
Coeficiente $a$ (nm/pixel) & $-0{,}06$ & 1,475 & Taxa de dispersão (nm por pixel) \\
Coeficiente $b$ (nm) & 203,14 & 195,7 & Intercepto (Wavelength Offset) \\
Precisão (validação) & — & $\pm$0,13--0,29 nm & Incerteza expandida, Exp. 1 (Cap. 4) \\
\hline
\end{tabular}
\fonte{Elaborada pelo autor (2025).}
\end{table}

\section{APLICAÇÃO DE VISÃO COMPUTACIONAL PARA CALIBRAÇÃO AUTOMATIZADA}

A Visão Computacional é o diferencial tecnológico que permite ao OSA Visível executar calibrações de forma automatizada, robusta e precisa, substituindo métodos manuais demorados ou dependentes de hardware dedicado.

\subsection{\textbf{Processamento Digital do Sinal Espectral (Imagens CMOS)}}

O \textit{pipeline} de processamento digital é crucial para extrair o dado espectral da imagem bruta capturada pela webcam. Uma etapa inicial essencial é a Média Temporal (\textit{Frame Averaging}). Em sensores CMOS de baixo custo, o ruído aleatório (como ruído de disparo ou ruído térmico) é significativo. Para a calibração com lasers, o software captura $N=20$ quadros em um curto intervalo e calcula a intensidade média $\bar{I}(x,y)$:

\begin{equation}
\bar{I}(x,y) = \frac{1}{N}\sum_{i=1}^{N} I_i(x,y)
\label{eq:frame_avg}
\end{equation}

O cálculo da média temporal melhora drasticamente a Relação Sinal-Ruído (SNR), permitindo a detecção mais precisa dos picos de intensidade dos lasers. Após a média, a imagem é convertida para escala de cinza, simplificando a análise da intensidade luminosa.

\subsection{\textbf{Segmentação e Limiarização Adaptativa de Imagem (Método de Otsu)}}

Para isolar o espectro (o sinal de interesse) do fundo escuro e do ruído residual da imagem, é necessária uma etapa de segmentação. O \textbf{Método de Otsu} é um algoritmo automático de limiarização global que opera maximizando a variância entre classes (\textit{foreground} vs. \textit{background}) no histograma de intensidade da imagem \cite{otsu1979}.

O Otsu calcula o limiar ótimo $T$ que melhor divide os pixels da imagem em duas classes, garantindo que o sinal espectral, mesmo que difuso, seja completamente capturado. Isso resulta em uma máscara binária $M(x,y)$:

\begin{equation}
M(x,y) = \begin{cases}
I_{gray}(x,y), & \textrm{se } I_{gray}(x,y) \geq T \\
0, & \textrm{caso contrário}
\end{cases}
\label{eq:threshold}
\end{equation}

A aplicação de um limiar adaptativo torna o processo de calibração robusto a variações na iluminação da fonte de luz branca e às condições ambientais, eliminando a necessidade de ajustes manuais do limiar.

\subsection{\textbf{Localização de Fontes: Centróide e Detecção de Picos}}

A visão computacional é usada para duas tarefas críticas de localização: o centróide para o espectro contínuo e a detecção de pico para os lasers de referência.

\textbf{Cálculo do Centróide:} O centróide $(x_c, y_c)$ representa o centro de massa ponderado pela intensidade dos pixels ativos dentro da máscara $M$ \cite{spectral_centroid_wiki}:

\begin{equation}
x_c = \frac{\sum_{x,y} x \cdot M(x,y)}{\sum_{x,y} M(x,y)}, \quad y_c = \frac{\sum_{x,y} y \cdot M(x,y)}{\sum_{x,y} M(x,y)}
\label{eq:centroid}
\end{equation}

Este cálculo é vital, pois o espectrômetro OSA Visível, devido à sua construção 3D com tolerâncias inerentes, pode apresentar um desalinhamento rotacional do espectro no sensor CMOS. O centróide fornece um ponto de referência central que permite à regressão linear preliminar definir corretamente a orientação espacial da linha espectral na imagem (a inclinação da reta $y=mx+c$), compensando o desalinhamento mecânico antes da calibração absoluta.

\textbf{Detecção de Picos:} Para os lasers de referência, a posição de comprimento de onda é determinada pelo pixel de máxima intensidade. A posição do pico ($x_{peak}$) é determinada pelo argumento máximo da função intensidade $I(x)$ ao longo da linha espectral:

\begin{equation}
x_{peak} = \arg \max_{x} \, I(x)
\label{eq:peak}
\end{equation}

Esta precisão na localização dos picos é o que garante a acurácia metrológica final da calibração, fornecendo os pontos fixos necessários para a determinação dos coeficientes $a$ e $b$.

A Tabela \ref{tab:algoritmos_visao} resume os algoritmos de visão computacional aplicados à calibração.

\begin{table}[ht]
\centering
\caption{Algoritmos de Visão Computacional Aplicados à Calibração}
\label{tab:algoritmos_visao}
\begin{tabular}{>{\raggedright\arraybackslash}p{3cm}>{\raggedright\arraybackslash}p{3cm}>{\raggedright\arraybackslash}p{3cm}>{\raggedright\arraybackslash}p{3.5cm}}
\hline
Algoritmo (Referência) & Propósito & Impacto Metrológico & Justificativa para Baixo Custo \\
\hline
Média Temporal & Aumento do SNR & Reduz erro aleatório na intensidade & Mitiga o ruído inerente a sensores CMOS de baixo custo \\
Limiarização Otsu \cite{otsu1979} & Segmentação ROI espectral & Isolamento do sinal de interesse & Automatiza o processo, tornando-o robusto a variações de iluminação \\
Cálculo de Centróide \cite{spectral_centroid_wiki} & Localização geométrica & Define a orientação espacial da dispersão & Compensa desalinhamentos mecânicos da estrutura 3D \\
Regressão Linear & Mapeamento $\lambda(x)$ & Converte pixel para nm com precisão funcional & Eficácia metrológica com baixo custo computacional \\
\hline
\end{tabular}
\fonte{Elaborada pelo autor (2025).}
\end{table}

\section{MODELAGEM DE PERFIS ESPECTRAIS E DETECÇÃO DE PICOS}

A extração de parâmetros úteis de um espectro (comprimento de onda central, intensidade e largura de pico) requer modelos que descrevam a forma das linhas espectrais. Perfis espectrais são tipicamente modelados por curvas Lorentzianas ou Gaussianas, cada uma associada a diferentes mecanismos físicos de alargamento \cite{spectral_line_shape}.

O perfil Lorentziano está ligado ao alargamento homogêneo: o efeito atua da mesma forma sobre todos os átomos ou moléculas. As causas principais incluem o tempo de vida finito do estado excitado (alargamento natural) e colisões entre átomos (alargamento por pressão). Matematicamente, a Lorentziana é expressa por
\begin{equation}
    I(\lambda) = I_0 \frac{\gamma^2}{(\lambda - \lambda_0)^2 + \gamma^2}
\end{equation}
onde $I_0$ é a intensidade máxima, $\lambda_0$ a posição central do pico e $\gamma$ está relacionado à largura à meia altura (FWHM $= 2\gamma$). O decaimento das ``asas'' da Lorentziana é lento ($\propto 1/\lambda^2$).

O perfil Gaussiano está associado ao alargamento inhomogêneo, como o efeito Doppler em amostras gasosas. A Gaussiana tem a forma $I(\lambda) = I_0 \exp\bigl(-(\lambda - \lambda_0)^2 / (2\sigma^2)\bigr)$, com FWHM $= 2\sigma\sqrt{2\ln 2}$. Suas asas decaem mais rapidamente que as da Lorentziana. A Figura \ref{fig:gauss_lorentz} ilustra a comparação visual entre os dois perfis padronizados.

\begin{figure}[ht]
\centering
\includegraphics[width=0.7\textwidth]{../images/Gauss_and_Lorentz_lineshapes.png}
\caption{Comparação entre perfis Gaussiano (vermelho) e Lorentziano (azul) padronizados. O HWHM ($w/2$) é 1.}
\label{fig:gauss_lorentz}
\fonte{\cite{spectral_line_shape}.}
\end{figure}

Em condições reais, perfis de Voigt (convolução Gaussiana--Lorentziana) podem ser necessários; em sistemas de baixo custo, a escolha entre Gaussiana e Lorentziana é frequentemente empírica, baseada na qualidade do ajuste aos dados \cite{spectral_line_shape}.

O refinamento dos parâmetros (posição, largura, amplitude) é feito por ajuste de mínimos quadrados não lineares, com algoritmos como Levenberg-Marquardt \cite{peak_spectroscopy}. A precisão do ajuste depende da relação sinal-ruído e da forma do perfil; para uma mesma SNR, Gaussianas permitem localização de centróide mais precisa, enquanto Lorentzianas oferecem melhor estimativa da área total devido à extensão de suas caudas.

\section{SATURAÇÃO EM SENSORES CMOS E MODELAGEM DA RESPOSTA DE INTENSIDADE}

A calibração do eixo de intensidade (potência) em espectrômetros que utilizam webcams exige atenção à saturação do sensor. A saturação ocorre quando o sinal excede a capacidade do conversor analógico-digital (ADC) ou do poço de potencial do pixel, causando achatamento dos picos e perda de linearidade entre irradiância incidente e intensidade registrada \cite{evident_dynamic_range}. Em sensores CMOS de 8 bits, a escala é limitada a 0--255 níveis; o achatamento transforma perfis Gaussianos ou Lorentzianos em estruturas de topo plano. A Figura \ref{fig:saturado} ilustra um caso real: no software ThorSpectra do espectrômetro ThorLabs CCT11, o \textit{Integration Time} foi de propósito aumentado com a fonte de PWM em 100\% de potência; em consequência, o sinal saturou. No ThorLabs, a intensidade é expressa em $2^{16}$ bits (0--65535); o topo plano do pico verde indica que o limite foi excedido.

\begin{figure}[ht]
\centering
\includegraphics[width=0.9\textwidth]{../images/saturado.png}
\caption{Exemplo de saturação no espectrômetro ThorLabs CCT11 (software ThorSpectra): topo plano do pico espectral em LED verde com \textit{Integration Time} elevado e potência 100\% da fonte PWM. Intensidade em $2^{16}$ bits.}
\label{fig:saturado}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

Antes da saturação abrupta, o sensor pode entrar em regime de ``saturação suave'': a resposta torna-se não linear (compressão de ganho) enquanto a relação irradiância--contagem digital ainda é contínua. Este comportamento é particularmente relevante em webcams com matriz Bayer, onde o crosstalk entre canais RGB e o processamento interno (demosaicing) introduzem artefatos adicionais.

Para modelar a resposta intensidade--duty cycle em uma faixa definida onde a saturação suave predomina, um polinômio de grau 2 ($f(x) = ax^2 + bx + c$) pode capturar a concavidade para baixo típica da compressão de ganho. Os coeficientes quadráticos negativos ($a < 0$) refletem a diminuição do ganho à medida que a irradiância aumenta. É importante notar que o polinômio de segundo grau é adequado apenas para uma região limitada do domínio: se extrapolado, a concavidade para baixo levaria a intensidades que diminuem e eventualmente tornam-se negativas para valores altos de $x$, em vez de atingir um platô como em uma saturação real. Portanto, o modelo polinomial deve ser utilizado estritamente dentro da faixa experimental calibrada.

\section{O PROCESSO HÍBRIDO DE CALIBRAÇÃO DO OSA VISÍVEL}

O processo de calibração da interface OSA Visível combina a visão computacional (Seções 2.4 e 2.5) com referências metrológicas de comprimento de onda conhecido. Consiste em duas etapas: (i) calibração preliminar com luz branca, para obter a orientação espacial do espectro na imagem (centróide, regressão da reta espectral) e os parâmetros iniciais $a$ e $b$; e (ii) calibração absoluta com lasers Verde (532 nm) e Vermelho (650 nm), para ancorar a escala: o software captura 20 quadros com média temporal, determina as posições dos picos ($x_{532}$, $x_{650}$) e calcula os coeficientes finais via \ref{eq:coeficientes}. A precisão metrológica é avaliada experimentalmente conforme descrito no Capítulo 4.

Essa correspondência entre as posições dos picos na reta de calibração e os comprimentos de onda reais garante que a dispersão (nm/pixel) seja corretamente escalada em toda a faixa de operação do OSA. A utilização de dois pontos fixos é essencial para definir inequivocamente tanto o \textit{offset} quanto a dispersão da reta linear.

\chapter{METODOLOGIA DE DESENVOLVIMENTO DO HARDWARE E SOFTWARE}

Este capítulo detalha os procedimentos metodológicos adotados para o desenvolvimento do espectrômetro OSA Visível e da interface OSA Visível. A metodologia abrange desde a seleção e montagem dos componentes ópticos até os processos de calibração espectral automatizada via visão computacional, assegurando a precisão e confiabilidade das medições espectrais na faixa visível (380-750 nm).

\section{FUNDAMENTAÇÃO METODOLÓGICA E TRABALHOS CORRELATOS}

A calibração de analisadores de espectro óptico (OSA) para a faixa visível tem sido amplamente explorada na literatura científica. \cite{dubard1995} discutiram a necessidade de caracterizar com precisão as fontes ópticas em medições de fibras ópticas e apresentaram técnicas de calibração para OSAs comerciais. Abordagens modernas, como as propostas por \cite{liu2013}, empregam métodos de calibração precisos utilizando parâmetros do sistema para espectrômetros de grade. Alternativamente, \cite{terra_calibration} propuseram três métodos para calibrar um OSA baseado em grade, utilizando fontes laser bem caracterizadas, duplicação de frequência em cristais não lineares e uma célula de gás de cianeto de hidrogênio (HCN) como referência de comprimento de onda.

No contexto de espectrômetros de baixo custo, trabalhos recentes têm demonstrado a viabilidade de utilizar componentes comerciais prontos para uso (COTS) e técnicas de fabricação aditiva. \cite{gaudi_spectrometer} desenvolveram o projeto \textit{Open Fiber Spectrometer}, um espectrômetro de código aberto que fornece modelos 3D e instruções detalhadas para construção, servindo como base para diversos projetos educacionais e de pesquisa.

A metodologia adotada neste trabalho diferencia-se das abordagens existentes por combinar uma estratégia híbrida de calibração: a calibração inicial com luz branca fornece uma relação linear preliminar, enquanto lasers de referência (532 nm e 650 nm) definem a escala absoluta, combinando assim simplicidade e baixo custo. Esta abordagem permite alcançar precisão metrológica adequada a um custo total inferior a \$200, democratizando o acesso à análise espectral.

\section{CONSTRUÇÃO DO ESPECTRÔMETRO OSA VISÍVEL}

\subsection{Seleção e Especificação dos Componentes}

O espectrômetro OSA Visível foi desenvolvido com base no projeto \textit{Open Fiber Spectrometer} \cite{gaudi_spectrometer}, um espectrômetro de código aberto que fornece modelos 3D e instruções detalhadas para construção. O projeto original foi adaptado para atender às necessidades específicas deste trabalho, com foco na faixa visível do espectro (380-750 nm).

A seleção dos componentes foi orientada por critérios de baixo custo, disponibilidade comercial e adequação às especificações técnicas necessárias para operação na faixa visível. A Tabela \ref{tab:componentes} apresenta os componentes principais e suas especificações.

\begin{table}[ht]
\centering
\caption{Componentes principais do espectrômetro OSA Visível e especificações técnicas}
\label{tab:componentes}
\begin{tabular}{>{\raggedright\arraybackslash}p{4cm}>{\raggedright\arraybackslash}p{3cm}>{\raggedright\arraybackslash}p{3cm}>{\raggedright\arraybackslash}p{2.5cm}}
\hline
Componente & Especificação & Função & Custo Aprox. (USD) \\
\hline
Estrutura 3D & PLA, impressão FDM & Suporte mecânico e alinhamento óptico & 5-10 \\
Grade de Difração & 1000 linhas/mm, transmissão & Dispersão espectral & 50-80 \\
Webcam USB & 640$\times$480 pixels, CMOS & Detecção espectral & 20-40 \\
Fonte de Luz Branca & LED RGB, CRI 82 & Calibração preliminar & 10-15 \\
Lasers de Referência & 532 nm (verde), 650 nm (vermelho) & Calibração absoluta & 30-50 \\
Fenda Óptica & Ajustável, 50-200 $\mu$m & Controle de resolução & 5-10 \\
\hline
\textbf{Total} & & & \textbf{< \$200} \\
\hline
\end{tabular}
\fonte{Elaborada pelo autor (2025).}
\end{table}

\subsection{Arquitetura Óptica e Princípios de Funcionamento}

A arquitetura óptica do espectrômetro OSA Visível segue o princípio clássico de um espectrômetro de grade de transmissão, adaptado para componentes de baixo custo. A Figura \ref{fig:osinha} ilustra a disposição dos componentes principais.

\begin{figure}[ht]
\centering
\includegraphics[width=0.6\textwidth]{../SBAI_SBSE_2025___OSA_Visível___Review/data/Osinha - PAPER.png}
\caption{Arquitetura do espectrômetro OSA Visível: (1) Luz incidente, (2) Fenda óptica, (3) Grade de difração, (4) Webcam CMOS. Adaptado de \cite{gaudi_spectrometer}.}
\label{fig:osinha}
\end{figure}

O caminho óptico segue a seguinte sequência:

\begin{enumerate}
    \item \textbf{Entrada de Luz}: A luz proveniente da amostra ou fonte de calibração entra através de uma fenda óptica ajustável, que controla a largura do feixe incidente e, consequentemente, a resolução espectral do sistema.
    
    \item \textbf{Dispersão Espectral}: A luz colimada incide sobre uma grade de difração de transmissão com densidade de 1000 linhas/mm. A relação entre o comprimento de onda ($\lambda$) e o ângulo de difração ($\theta$) é governada pela equação da grade de Fraunhofer:
    
    \begin{equation}
        n\lambda = d(\sin\theta + \sin\alpha)
        \label{eq:diffraction_metodologia}
    \end{equation}
    
    onde $n$ representa a ordem de difração (geralmente $n=1$), $d = 1\,\mu\text{m}$ é o espaçamento da grade (inverso da densidade de linhas), e $\alpha$ é o ângulo de incidência da luz na grade \cite{fraunhofer_wiki}.
    
    \item \textbf{Detecção}: O espectro disperso é capturado por um sensor CMOS de uma webcam USB, posicionado no plano focal da grade. O sensor discretiza a informação espectral em uma matriz de pixels, onde cada coluna corresponde a uma faixa de comprimentos de onda.
\end{enumerate}

\subsection{Fabricação da Estrutura por Impressão 3D}

A estrutura física do espectrômetro foi projetada utilizando software de modelagem 3D (CAD) e fabricada por meio de impressão 3D utilizando tecnologia de modelagem por deposição fundida (FDM - \textit{Fused Deposition Modeling}). Esta abordagem oferece várias vantagens estratégicas:

\begin{itemize}
    \item \textbf{Custo Reduzido}: A impressão 3D elimina a necessidade de ferramentas especializadas e processos de usinagem de precisão, reduzindo drasticamente os custos de fabricação \cite{stanford_3d_optics}.
    
    \item \textbf{Personalização}: O design pode ser facilmente modificado e adaptado para diferentes aplicações ou requisitos específicos, sem custos adicionais significativos.
    
    \item \textbf{Reprodutibilidade}: Os arquivos de modelo 3D podem ser compartilhados e replicados em qualquer local com acesso a uma impressora 3D, facilitando a disseminação do projeto.
    
    \item \textbf{Integração de Componentes}: A estrutura impressa incorpora suportes e guias para posicionamento preciso dos componentes ópticos, garantindo alinhamento adequado sem necessidade de ajustes mecânicos complexos.
\end{itemize}

O material utilizado foi filamento de ácido polilático (PLA), escolhido por sua estabilidade dimensional, facilidade de impressão e baixo custo. A resolução de impressão foi configurada para 0,2 mm de altura de camada, garantindo superfícies suficientemente lisas para aplicações ópticas de baixa precisão.

\subsection{Montagem e Alinhamento Óptico}

O processo de montagem seguiu uma sequência sistemática para garantir o alinhamento adequado dos componentes:

\begin{enumerate}
    \item \textbf{Instalação da Estrutura Base}: A estrutura impressa em 3D foi montada e verificada quanto à integridade estrutural e dimensional.
    
    \item \textbf{Posicionamento da Fenda Óptica}: A fenda foi instalada na entrada óptica e ajustada para uma largura de aproximadamente 100 $\mu$m, otimizando o compromisso entre resolução espectral e intensidade do sinal.
    
    \item \textbf{Instalação da Grade de Difração}: A grade foi posicionada perpendicularmente ao eixo óptico, com o ângulo de incidência ($\alpha$) ajustado para aproximadamente 45$^\circ$, garantindo dispersão adequada na faixa visível.
    
    \item \textbf{Posicionamento do Detector}: A webcam foi fixada na estrutura de forma que o sensor CMOS capture todo o espectro disperso, com o eixo horizontal do sensor alinhado com a direção de dispersão.
    
    \item \textbf{Verificação do Alinhamento}: O alinhamento foi verificado visualmente utilizando uma fonte de luz branca, observando a formação de um espectro contínuo e uniforme no sensor.
\end{enumerate}

\subsection{Caracterização do Sistema de Detecção}

O sistema de detecção baseado em webcam USB apresenta características específicas que influenciam o desempenho do espectrômetro. O sensor CMOS utilizado possui resolução de $640 \times 480$ pixels, com taxa de amostragem de 30 fps. A discretização do sinal óptico é representada pela equação:

\begin{equation}
    I(x,y) = \sum_{k=0}^{255} k \cdot P(k|x,y)
    \label{eq:sampling_metodologia}
\end{equation}

onde $I(x,y)$ é a intensidade digital no pixel $(x,y)$, $k$ representa os níveis de intensidade (0 a 255 em escala de 8 bits), e $P(k|x,y)$ é a probabilidade do pixel $(x,y)$ registrar a intensidade $k$.

Uma característica importante do sensor CMOS é a presença de uma matriz de filtros Bayer (RGB), que significa que cada pixel é sensível a uma faixa específica do espectro (vermelho, verde ou azul). Para a calibração espectral, esta característica é contornada através da conversão para escala de cinza, que integra a resposta espectral dos três canais de cor.

\section{DESENVOLVIMENTO DA INTERFACE OSA VISÍVEL}

\subsection{Arquitetura e Plataforma de Desenvolvimento}

A interface OSA Visível foi desenvolvida em Python 3.8+, escolhido por sua portabilidade, vasta gama de bibliotecas científicas e facilidade de integração com hardware. A arquitetura do software segue um modelo modular, separando as funcionalidades de aquisição de dados, processamento de imagem, calibração e visualização.

As principais bibliotecas utilizadas incluem:

\begin{itemize}
    \item \textbf{OpenCV (cv2)}: Para aquisição de vídeo, processamento de imagem e implementação de algoritmos de visão computacional.
    
    \item \textbf{Pillow (PIL)}: Para manipulação adicional de imagens e conversão de formatos.
    
    \item \textbf{NumPy}: Para operações numéricas e manipulação de arrays multidimensionais.
    
    \item \textbf{SciPy}: Para funções científicas avançadas, incluindo regressão linear e processamento de sinais.
    
    \item \textbf{Matplotlib}: Para visualização de gráficos e espectros.
    
    \item \textbf{Tkinter}: Para desenvolvimento da interface gráfica do usuário (GUI).
\end{itemize}

A compatibilidade multiplataforma (Windows 10/11 e Linux Ubuntu 22.04) foi garantida através do uso de bibliotecas padrão e testes extensivos em ambos os ambientes.

\subsection{Interface Gráfica do Usuário}

A interface gráfica foi projetada para guiar o usuário através de um fluxo intuitivo de operação, dispensando conhecimentos avançados em programação. A Figura \ref{fig:gui_principal} ilustra a janela principal do software.

\begin{figure}[ht]
\centering
\includegraphics[width=0.7\textwidth]{../SBAI_SBSE_2025___OSA_Visível___Review/data/janela_principal_recursos.png}
\caption{Janela principal da interface OSA Visível: (1) Visualização do espectro em tempo real, (2) Gráfico de intensidade $I(\lambda)$ vs. comprimento de onda, (3) Painel de controle e calibração.}
\label{fig:gui_principal}
\end{figure}

As principais funcionalidades da interface incluem:

\begin{itemize}
    \item \textbf{Visualização em Tempo Real}: Exibição contínua do espectro capturado pela webcam, permitindo monitoramento visual da qualidade do sinal.
    
    \item \textbf{Gráficos Espectrais}: Visualização dos dados processados em formato de gráfico $I(\lambda)$, com opções de zoom e análise de picos.
    
    \item \textbf{Painel de Calibração}: Acesso rápido às ferramentas de calibração, com assistente passo a passo para guiar o usuário.
    
    \item \textbf{Exportação de Dados}: Funcionalidade para salvar espectros em formato texto (.txt) para análise posterior.
    
    \item \textbf{Configurações do Sistema}: Ajustes de parâmetros da webcam, seleção de dispositivo de vídeo e configurações de processamento.
\end{itemize}

\section{PROCESSO DE CALIBRAÇÃO AUTOMATIZADA}

A calibração do espectrômetro é o processo crítico que estabelece a correspondência precisa entre a posição dos pixels no sensor CMOS e os comprimentos de onda correspondentes. O método desenvolvido combina técnicas de visão computacional com referências metrológicas de comprimento de onda conhecido, resultando em um processo híbrido automatizado.

\subsection{Etapa 1: Calibração Preliminar com Luz Branca}

A primeira etapa do processo de calibração utiliza o espectro contínuo de uma fonte de luz branca para estabelecer uma relação preliminar entre posição de pixel e comprimento de onda. Esta etapa é fundamental para compensar desalinhamentos mecânicos e definir a orientação espacial do espectro na imagem.

\subsubsection{Aquisição do Sinal Digital}

A calibração inicia com a captura de um único quadro ($N=1$) do espectro contínuo via biblioteca OpenCV. A escolha de um único quadro é adequada para esta etapa, pois o espectro contínuo de luz branca apresenta alta intensidade e baixa variabilidade temporal, não requerendo média temporal para redução de ruído.

O processo de aquisição segue os seguintes passos:

\begin{enumerate}
    \item Inicialização da webcam através da interface OpenCV.
    
    \item Configuração dos parâmetros de captura: resolução (640$\times$480), formato de cor (RGB), e taxa de quadros (30 fps).
    
    \item Captura de um quadro estático do espectro, armazenado como array NumPy de dimensões $(480, 640, 3)$, representando altura, largura e canais de cor (RGB).
\end{enumerate}

\subsubsection{Pré-processamento com Visão Computacional}

O pré-processamento da imagem é essencial para isolar o sinal espectral do fundo e do ruído, preparando os dados para análise quantitativa.

\textbf{Conversão para Escala de Cinza:}

A imagem RGB capturada é convertida para escala de cinza utilizando a média ponderada dos canais de cor:

\begin{equation}
    I_{gray}(x,y) = \frac{R(x,y) + G(x,y) + B(x,y)}{3}
    \label{eq:grayscale}
\end{equation}

onde $R(x,y)$, $G(x,y)$ e $B(x,y)$ são as intensidades dos canais vermelho, verde e azul no pixel $(x,y)$, respectivamente. Esta conversão simplifica a análise posterior, integrando a resposta espectral dos três canais de cor do sensor Bayer.

\textbf{Segmentação por Limiarização Adaptativa:}

Para isolar o espectro (sinal de interesse) do fundo escuro e do ruído residual, é aplicada uma etapa de segmentação utilizando o método de Otsu \cite{otsu1979}. Este método calcula automaticamente o limiar ótimo $T$ que maximiza a variância entre classes (foreground vs. background) no histograma de intensidade da imagem.

O método de Otsu opera da seguinte forma:

\begin{enumerate}
    \item Cálculo do histograma de intensidades da imagem em escala de cinza.
    
    \item Para cada possível valor de limiar $t$ (0 a 255), cálculo da variância entre classes:
    
    \begin{equation}
        \sigma_B^2(t) = \omega_0(t)\omega_1(t)[\mu_0(t) - \mu_1(t)]^2
    \end{equation}
    
    onde $\omega_0(t)$ e $\omega_1(t)$ são as probabilidades das classes (fundo e objeto), e $\mu_0(t)$ e $\mu_1(t)$ são as médias das classes.
    
    \item Seleção do limiar $T$ que maximiza $\sigma_B^2(t)$.
\end{enumerate}

A aplicação do limiar resulta em uma máscara binária $M(x,y)$:

\begin{equation}
    M(x,y) = \begin{cases}
        I_{gray}(x,y), & \text{se } I_{gray}(x,y) \geq T \\
        0, & \text{caso contrário}
    \end{cases}
    \label{eq:threshold_metodologia}
\end{equation}

A utilização de um limiar adaptativo torna o processo robusto a variações na iluminação da fonte de luz branca e às condições ambientais, eliminando a necessidade de ajustes manuais.

\subsubsection{Cálculo do Centróide e Regressão Linear Preliminar}

\textbf{Cálculo do Centróide:}

O centróide $(x_c, y_c)$ representa o centro de massa ponderado pela intensidade dos pixels ativos dentro da máscara $M$ \cite{spectral_centroid_wiki}:

\begin{equation}
    x_c = \frac{\sum_{x,y} x \cdot M(x,y)}{\sum_{x,y} M(x,y)}, \quad
    y_c = \frac{\sum_{x,y} y \cdot M(x,y)}{\sum_{x,y} M(x,y)}
    \label{eq:centroid_metodologia}
\end{equation}

Este cálculo é vital, pois o espectrômetro OSA Visível, devido à sua construção 3D com tolerâncias inerentes, pode apresentar um desalinhamento rotacional do espectro no sensor CMOS. O centróide fornece um ponto de referência central que permite à regressão linear preliminar definir corretamente a orientação espacial da linha espectral na imagem.

\textbf{Regressão Linear para Orientação Espacial:}

Após a segmentação, os pixels ativos ($M(x,y) \geq T$) formam uma nuvem de pontos ao longo do espectro. Uma regressão linear é aplicada para determinar a inclinação da reta espectral ($y = m \cdot x + c$), que define o eixo de dispersão.

A regressão linear é obtida via método dos mínimos quadrados, minimizando:

\begin{equation}
    \min_{m,c} \sum_{x,y} \left(y - (m \cdot x + c)\right)^2
    \label{eq:regression_metodologia}
\end{equation}

Os coeficientes $m$ (inclinação) e $c$ (intercepto) definem a orientação espacial do espectro. Combinado com o centróide, esta reta estabelece uma relação preliminar entre posição de pixel e comprimento de onda, que será posteriormente ajustada pelos lasers de referência.

Os parâmetros preliminares $a$ e $b$ da relação $\lambda(x) = a \cdot x + b$ são calculados com base nesta orientação inicial. A calibração com lasers refine os parâmetros; a validação experimental (Cap. 4) demonstrou incertezas expandidas entre $\pm$0,13 nm e $\pm$0,29 nm (Experimento 1, 100 amostras temporais) e concordância com o espectrômetro ThorLabs.

\subsection{Etapa 2: Calibração Absoluta com Lasers de Referência}

A segunda etapa do processo de calibração é a fase de ancoragem metrológica. Após a calibração inicial que alinha espacialmente o espectro, os lasers de referência são utilizados para mapear essa reta de dispersão preliminar aos comprimentos de onda absolutos conhecidos.

\subsubsection{Seleção das Fontes de Referência}

São utilizados dois lasers de comprimento de onda conhecido:

\begin{itemize}
    \item \textbf{Laser Verde}: Comprimento de onda $\lambda_{\text{verd}} = 532$ nm, correspondente ao segundo harmônico de um laser Nd:YAG.
    
    \item \textbf{Laser Vermelho}: Comprimento de onda $\lambda_{\text{verm}} = 650$ nm, típico de diodos laser de baixa potência.
\end{itemize}

A escolha destes dois comprimentos de onda específicos é estratégica:

\begin{enumerate}
    \item \textbf{Cobertura Espectral}: Os dois pontos estão distribuídos ao longo da faixa visível, permitindo uma calibração linear adequada para toda a faixa de operação (380-750 nm).
    
    \item \textbf{Disponibilidade e Custo}: Lasers de 532 nm e 650 nm são amplamente disponíveis comercialmente a baixo custo, adequados para aplicações educacionais.
    
    \item \textbf{Precisão Metrológica}: Lasers de diodo apresentam estabilidade de comprimento de onda adequada ($\pm 1$ nm) para a precisão desejada do sistema.
\end{enumerate}

\subsubsection{Aquisição com Média Temporal}

Para a calibração utilizando lasers, $N=20$ quadros são capturados em um intervalo homogêneo de tempo (aproximadamente 2 segundos). A média temporal é aplicada para reduzir o ruído aleatório inerente a sensores CMOS de baixo custo:

\begin{equation}
    \bar{I}(x,y) = \frac{1}{N}\sum_{i=1}^{N} I_i(x,y)
    \label{eq:frame_avg_metodologia}
\end{equation}

O cálculo da média temporal melhora drasticamente a Relação Sinal-Ruído (SNR), permitindo a detecção mais precisa dos picos de intensidade dos lasers. Em sensores CMOS de baixo custo, o ruído aleatório (ruído de disparo, ruído térmico) é significativo, e a média temporal é uma técnica eficaz e computacionalmente simples para mitigá-lo.

\subsubsection{Detecção de Picos de Intensidade}

A posição exata dos picos de intensidade dos lasers ($x_{532}$ e $x_{650}$) é determinada pelo cálculo do argumento máximo (Arg Max) ao longo da linha espectral previamente identificada:

\begin{equation}
    x_{peak} = \arg \max_{x} \, I(x)
    \label{eq:peak_metodologia}
\end{equation}

onde $I(x)$ é a intensidade média ao longo da direção vertical (eixo $y$) para cada posição horizontal $x$:

\begin{equation}
    I(x) = \frac{1}{H}\sum_{y=0}^{H-1} \bar{I}(x,y)
\end{equation}

e $H$ é a altura da imagem (480 pixels).

Esta precisão na localização dos picos é o que garante a acurácia metrológica final da calibração, fornecendo os pontos fixos necessários para a determinação dos coeficientes $a$ e $b$.

\subsubsection{Cálculo dos Coeficientes de Calibração Final}

Utilizando as coordenadas absolutas (pico de pixel, comprimento de onda real), o software calcula os coeficientes finais $a$ e $b$ que definem a relação $\lambda(x) = a \cdot x + b$.

Os coeficientes são calculados diretamente a partir da posição dos picos de intensidade dos lasers:

\begin{equation}
    a = \frac{\lambda_{\text{verm}} - \lambda_{\text{verd}}}{x_{\text{verm}} - x_{\text{verd}}}, \quad
    b = \lambda_{\text{verd}} - a \cdot x_{\text{verd}}
    \label{eq:coeficientes_metodologia}
\end{equation}

onde $x_{\text{verd}}$ e $x_{\text{verm}}$ são as posições dos picos dos lasers verde e vermelho, respectivamente.

A utilização de dois pontos fixos é essencial para definir inequivocamente tanto o \textit{offset} ($b$) quanto a dispersão ($a$) da reta linear. Um único ponto definiria apenas o \textit{offset}, mas deixaria a taxa de dispersão sujeita a erros sistêmicos. A determinação de ambos os parâmetros por dois pontos de referência garante que o escalonamento da dispersão angular seja corretamente aplicado em toda a faixa de operação do espectrômetro, minimizando o erro de inclinação.

A Figura \ref{fig:calib_curve} ilustra a curva de calibração obtida experimentalmente.

\begin{figure}[ht]
\centering
\includegraphics[width=0.5\textwidth]{../SBAI_SBSE_2025___OSA_Visível___Review/data/calibration_curve.png}
\caption{Reta de calibração $\lambda(x) = a \cdot x + b$ ajustada via regressão linear utilizando lasers de referência (532 nm e 650 nm).}
\label{fig:calib_curve}
\end{figure}

\subsection{Validação da Calibração e Métricas de Precisão}

A acurácia do mapeamento comprimento de onda-pixel é avaliada utilizando o Erro Quadrático Médio (Root Mean Square Error - RMS), uma métrica padrão na metrologia espectral que quantifica a magnitude média do erro entre os valores medidos e os valores de referência \cite{henriksen_calibration}.

O processo híbrido demonstra melhoria de precisão em relação ao ajuste preliminar; a validação experimental (Capítulo 4) reporta incertezas expandidas e concordância com espectrômetro de referência.

A Tabela \ref{tab:calib_params_metodologia} apresenta os parâmetros de calibração obtidos experimentalmente.

\begin{table}[ht]
\centering
\caption{Parâmetros de calibração obtidos experimentalmente}
\label{tab:calib_params_metodologia}
\begin{tabular}{lcc}
\toprule
Parâmetro & Luz Branca & Lasers (Final) \\
\midrule
Coeficiente $a$ (nm/pixel) & $-0{,}061$ & 1,475 \\
Coeficiente $b$ (nm) & 203,14 & 195,7 \\
Precisão (validação) & — & $\pm$0,13--0,29 nm (Exp. 1, Cap. 4) \\
\bottomrule
\end{tabular}
\fonte{Elaborada pelo autor (2025).}
\end{table}

A escolha do modelo de primeira ordem é validada pelos resultados de repetibilidade temporal e de comparação cruzada apresentados no Capítulo 4.

\subsection{Módulo de Calibração}

O módulo de calibração da interface OSA Visível foi projetado para guiar o usuário através do processo de calibração de forma intuitiva e automatizada. A Figura \ref{fig:calib_window} ilustra a janela de calibração.

\begin{figure}[ht]
\centering
\includegraphics[width=0.5\textwidth]{../SBAI_SBSE_2025___OSA_Visível___Review/data/calibration_window.png}
\caption{Janela de calibração da interface OSA Visível: (1) Botão "Calibrar Luz Branca" para calibração automática preliminar, (2) Botões "Iniciar Laser (Verde/Vermelho)" para calibração absoluta passo a passo.}
\label{fig:calib_window}
\end{figure}

O fluxo de calibração automatizada inclui:

\begin{enumerate}
    \item \textbf{Calibração com Luz Branca}:
    \begin{itemize}
        \item O usuário posiciona uma fonte de luz branca na entrada do espectrômetro.
        \item Clica no botão "Calibrar Luz Branca".
        \item O software executa automaticamente: captura de quadro, pré-processamento, cálculo de centróide e regressão linear preliminar.
        \item Os parâmetros preliminares são salvos e exibidos na interface.
    \end{itemize}
    
    \item \textbf{Calibração com Lasers}:
    \begin{itemize}
        \item O usuário é guiado passo a passo para posicionar cada laser (verde e vermelho) sequencialmente.
        \item Para cada laser, o software captura 20 quadros, aplica média temporal e detecta o pico de intensidade.
        \item Após ambos os lasers serem calibrados, o software calcula automaticamente os coeficientes finais $a$ e $b$.
        \item A curva de calibração é exibida graficamente e os parâmetros finais são salvos.
    \end{itemize}
\end{enumerate}

\section{EXPERIMENTO DE CARACTERIZAÇÃO DE FONTE E RELAÇÃO OSA VISÍVEL--THORLABS}

Esta seção descreve a metodologia adotada para o experimento de caracterização de uma fonte de luz controlada e para a obtenção da relação entre os espectros medidos pelo OSA Visível e pelo espectrômetro ThorLabs. O objetivo é caracterizar a resposta de ambos os equipamentos a uma fonte com LEDs vermelho, verde e azul, cuja intensidade pode ser variada via PWM, e modelar a combinação dos canais RGB do OSA Visível para aproximar as medições do espectrômetro ThorLabs.

\subsection{Fonte de Luz e Configuração do PWM}

A fonte de luz utilizada consistiu em três LEDs de cores verde, vermelho e azul, permitindo o acionamento individual de cada cor. A intensidade de cada LED foi controlada mediante modulação por largura de pulso (PWM), com a possibilidade de salvar espectros para cada LED separadamente.

Conforme a fundamentação sobre saturação (Seção 2.7), em experimentos preliminares com duty cycle de até 100\% (variando de 5\% em 5\%), todos os canais RGB da câmera do OSA Visível saturaram, ao passo que o espectrômetro ThorLabs manteve resposta linear. Diante disso, optou-se por restringir o experimento à faixa de 1\% a 10\% do duty cycle total da fonte, com variação de 1\% em 1\%.

\subsection{Setup Experimental}

\begin{figure}[ht]
\centering
\includegraphics[width=0.85\textwidth]{../images/setup_visible_osa_fonte_pwm.png}
\caption{Setup do experimento de caracterização: (1) Fonte de luz com LEDs verde, vermelho e azul e controle PWM; (2) Espectrômetro OSA Visível; (3) Interface OSA Visível.}
\label{fig:setup_caracterizacao}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=0.85\textwidth]{../images/setup_thorlabs_fonte_pwm.png}
\caption{Setup do experimento de caracterização: (1) Fonte de luz com LEDs verde, vermelho e azul e controle PWM; (2) Espectrômetro ThorLabs.}
\label{fig:setup_caracterizacao_thorlabs}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

% TODO: Inserir figura do espectrômetro ThorLabs conectado à fonte PWM (imagem separada)
%\begin{figure}[ht]
%\centering
%\includegraphics[width=0.85\textwidth]{../images/setup_thorlabs_fonte_pwm.jpg}
%\caption{Espectrômetro compacto ThorLabs (modelo CCT11, 350--700 nm, resolução $<$ 0,5 nm) conectado à fonte de luz com controle PWM.}
%\label{fig:setup_thorlabs}
%\fonte{Elaborada pelo autor (2025).}
%\end{figure}

\subsection{Coleta de Dados}

\subsubsection{Espectrômetro ThorLabs (CCT11)}

Foram realizadas 5 tomadas (replicatas experimentais). Em cada tomada, foram salvos espectros para cada LED (verde, vermelho e azul) em 10 níveis de PWM (1\%, 2\%, \ldots, 10\%), totalizando 30 espectros por tomada. O conjunto completo resultou em 150 espectros. As configurações do software do espectrômetro ThorLabs incluíram \textit{Integration Time} de 10 ms.

O eixo Y (intensidade) do espectrômetro ThorLabs está em contagens (\textit{counts}): valor de saída do conversor analógico-digital (ADC). Cada fóton incidente no sensor gera elétrons convertidos em voltagem e, em seguida, em valor numérico. Em sensores típicos de 16 bits, a escala varia de 0 a 65.535 contagens.

\subsubsection{OSA Visível}

A coleta com o OSA Visível foi feita pela interface OSA Visível, calibrada com lasers (532 nm e 650 nm). A diferença em relação ao espectrômetro ThorLabs reside na segmentação por visão computacional: além do espectro combinado (RGB), foram gravados espectros separados para os canais R, G e B da câmera. Com isso, a quantidade de espectros foi 4 vezes maior (combinado + R + G + B), totalizando 600 espectros para análise.

\subsection{Extração de Picos e Registro de Dados}

Conforme fundamentado na Seção 2.6, a determinação do comprimento de onda e da intensidade de cada pico foi realizada com o auxílio do software \textit{Peaks Viewer} (\texttt{peaks\_viewer.py}), desenvolvido em Python. O usuário seleciona manualmente a região de interesse no espectro; o refinamento dos parâmetros (posição, largura, amplitude) é feito por ajuste de mínimos quadrados não lineares \cite{peak_spectroscopy}. Em testes preliminares, a curva Gaussiana foi descartada por apresentar ajuste inferior ao Lorentziano nos espectros obtidos; optou-se, portanto, exclusivamente pelo modelo Lorentziano. Os valores de $\lambda$ e intensidade são obtidos a partir desse ajuste e registrados.

\begin{figure}[ht]
\centering
\includegraphics[width=0.85\textwidth]{../images/peaks_viewer.png}
\caption{Interface do \textit{Peaks Viewer}: visualização do espectro, seleção de região para ajuste de curva Lorentziana e extração de $\lambda$ e intensidade do pico.}
\label{fig:peaks_viewer}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

Todos os dados (duty cycle, $\lambda$ de pico e intensidade para cada LED e equipamento) foram registrados em uma aplicação web (\texttt{Experimentos/app/index.html}), que permite preencher tabelas por equipamento (OSA Visível e espectrômetro ThorLabs), tomada, tipo de espectro (no OSA Visível: combinado, canal R, canal G, canal B) e duty cycle (1--10\%).

\begin{figure}[ht]
\centering
\includegraphics[width=1\textwidth]{../images/web_app.png}
\caption{Interface da aplicação web de cadastro de dados: tabelas para duty cycle, $\lambda$ de pico e intensidade por LED (verde, vermelho, azul), com suporte a OSA Visível (por canal) e espectrômetro ThorLabs.}
\label{fig:app_cadastro}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

\subsection{Análise de Dados em MATLAB}

A caracterização da fonte e a modelagem da relação entre equipamentos foram realizadas em MATLAB. Dois scripts foram utilizados para a caracterização da resposta intensidade--duty cycle:

\begin{itemize}
    \item \texttt{analise\_json\_com\_ajuste.m}: ajuste linear (regressão de reta) para espectrômetro ThorLabs e OSA Visível.
    \item \texttt{analise\_json\_ajuste\_poly2.m}: ajuste linear para espectrômetro ThorLabs e polinômio de grau 2 para o OSA Visível em todos os canais.
\end{itemize}

Em ambos os casos, utilizam-se as médias das 5 tomadas e o coeficiente de determinação $R^2$ para avaliar a qualidade do ajuste.

\subsection{Modelagem da Combinação de Canais}

O script \texttt{modelagem\_combinacao\_canais.m} modela a relação entre os canais R, G e B do OSA Visível e a intensidade medida pelo espectrômetro ThorLabs. O modelo assume uma combinação linear:

\begin{equation}
    P_{\text{ThorLabs CCT11}} = \alpha_1 f_R(x) + \alpha_2 f_G(x) + \alpha_3 f_B(x)
\label{eq:combinacao_canais}
\end{equation}

onde $f_i(x) = a_i x^2 + b_i x + c_i$ são polinômios de grau 2 ajustados para cada canal do OSA Visível em função do duty cycle $x$, e $\alpha_1$, $\alpha_2$, $\alpha_3$ são os coeficientes obtidos por mínimos quadrados. O ajuste é avaliado por $R^2$, RMSE, MAE e erro percentual médio.

\section{CONSIDERAÇÕES METODOLÓGICAS E LIMITAÇÕES}

A metodologia desenvolvida apresenta algumas limitações inerentes à escolha de componentes de baixo custo e à simplificação do modelo de calibração:

\begin{itemize}
    \item \textbf{Modelo Linear}: A escolha da regressão linear de primeira ordem, embora funcional na faixa visível, pode introduzir erros sistemáticos maiores nas extremidades do espectro (abaixo de 400 nm e acima de 700 nm), onde a não-linearidade da Equação de Difração de Fraunhofer se manifesta mais intensamente.
    
    \item \textbf{Resolução Espectral}: A resolução espectral do sistema é limitada pela resolução espacial do sensor CMOS (640 pixels) e pela largura da fenda óptica, resultando em uma resolução de aproximadamente 0.5 nm/pixel na faixa visível.
    
    \item \textbf{Estabilidade Temporal}: Componentes de baixo custo podem apresentar variações temporais de calibração devido a efeitos térmicos ou envelhecimento, requerendo recalibração periódica.
    
    \item \textbf{Resposta Espectral do Sensor}: A matriz de filtros Bayer do sensor CMOS introduz uma resposta espectral não-uniforme que, embora parcialmente compensada pela conversão para escala de cinza, pode afetar a precisão de medições de intensidade absoluta.
\end{itemize}

\chapter{RESULTADOS EXPERIMENTAIS E VALIDAÇÃO}

Este capítulo apresenta os resultados experimentais obtidos com o OSA Visível desenvolvido neste trabalho, incluindo análise de repetibilidade temporal, comparação com o espectrômetro ThorLabs e validação estatística do sistema. Os experimentos foram conduzidos para avaliar a precisão, estabilidade e confiabilidade do sistema de baixo custo em condições de medição repetidas.

\section{DESCRIÇÃO DO SETUP EXPERIMENTAL}

Os experimentos foram realizados utilizando o espectrômetro OSA Visível desenvolvido conforme descrito no Capítulo 3, e o espectrômetro compacto ThorLabs (modelo CCT11, 350--700 nm) como referência para validação cruzada. % TODO: Adicionar figura do setup experimental (Figura \ref{fig:setup_experimental}) quando a imagem estiver disponível.

%\begin{figure}[ht]
%\centering
%\includegraphics[width=0.8\textwidth]{setup_experimental.png}
%\caption{Configuração experimental: (1) Espectrômetro OSA Visível, (2) Fonte de luz com picos RGB característicos, (3) Sistema de acoplamento óptico, (4) Computador para aquisição e processamento de dados.}
%\label{fig:setup_experimental}
%\fonte{Elaborado pelo autor (2025).}
%\end{figure}

O setup experimental foi configurado em um ambiente controlado, minimizando variações de temperatura e iluminação ambiente. A fonte de luz utilizada consistiu em uma fonte de LED RGB com picos espectrais característicos nas faixas do azul (aproximadamente 460 nm), verde (aproximadamente 520 nm) e vermelho (aproximadamente 640 nm). O acoplamento óptico foi mantido constante durante todas as medições para garantir reprodutibilidade.

Para os experimentos temporais, a fonte de luz foi mantida em operação contínua e estável, enquanto o espectrômetro realizava aquisições sequenciais de espectros. O intervalo de tempo entre aquisições foi configurado para 10 segundos, permitindo capturar possíveis variações temporais no sistema enquanto mantinha a fonte de luz em regime estacionário.

\section{EXPERIMENTO 1: ANÁLISE DE REPETIBILIDADE TEMPORAL COM OSA VISÍVEL}

\subsection{\textbf{Procedimento Experimental}}

O primeiro experimento visou avaliar a repetibilidade e estabilidade do OSA Visível através da aquisição de uma série temporal de espectros. O procedimento experimental seguiu os seguintes passos:

\begin{enumerate}
    \item \textbf{Calibração Inicial:} O OSA Visível foi calibrado utilizando o processo híbrido descrito no Capítulo 3, envolvendo calibração preliminar com luz branca seguida de calibração absoluta com lasers de referência (532 nm e 650 nm).
    
    \item \textbf{Aquisição Temporal:} Após a calibração, uma fonte de luz com espectro característico (LED RGB) foi posicionada na entrada do espectrômetro. O sistema foi configurado para realizar aquisições automáticas a cada 10 segundos, totalizando 100 amostras espectrais.
    
    \item \textbf{Processamento e Análise:} Cada espectro adquirido foi processado automaticamente pela interface OSA Visível, extraindo os dados de intensidade em função do comprimento de onda. Os espectros foram então analisados utilizando algoritmos de detecção de picos implementados em Python, baseados em \texttt{scipy.signal.find\_peaks} com parâmetros de \textit{prominence} e \textit{distance} otimizados para a faixa visível.
    
    \item \textbf{Agrupamento de Picos:} Os picos detectados em cada espectro foram agrupados utilizando clustering hierárquico (\texttt{scipy.cluster.hierarchy}), permitindo identificar picos correspondentes entre as diferentes amostras e calcular estatísticas de repetibilidade.
\end{enumerate}

\subsection{\textbf{Resultados e Análise Estatística}}

A análise estatística dos 100 espectros temporais revelou a presença de múltiplos picos espectrais, dos quais três foram identificados como os picos principais RGB. A Tabela \ref{tab:resultados_visible_osa} apresenta as estatísticas dos 3 picos principais identificados.

\begin{table}[ht]
\centering
\caption{Estatísticas dos 3 picos principais RGB identificados pelo OSA Visível (100 amostras temporais)}
\label{tab:resultados_visible_osa}
{\small
\begin{tabular}{lcccccc}
\toprule
Pico RGB & $\lambda$ (nm) & $\sigma$ (nm) & U (nm) & Taxa det. (\%) & Int. média & CV (\%) \\
\midrule
RGB-2 (Azul) & 468,22 & 1,469 & $\pm$0,288 & 100,0 & 122,12 & 1,12 \\
RGB-1 (Verde) & 516,10 & 0,682 & $\pm$0,134 & 100,0 & 177,85 & 0,61 \\
RGB-3 (Vermelho) & 637,70 & 0,701 & $\pm$0,143 & 92,0 & 84,23 & 0,38 \\
\bottomrule
\end{tabular}
}\\[0.5ex]
\footnotesize U = incerteza expandida; Taxa det. = taxa de detecção; Int. média = intensidade média; CV = coeficiente de variação.
\fonte{Elaborada pelo autor (2025).}
\end{table}

Os resultados demonstram excelente estabilidade e repetibilidade do sistema. O pico verde apresentou a maior estabilidade, com desvio padrão de apenas 0,682 nm e taxa de detecção de 100\% em todas as 100 amostras. O pico azul, embora tenha apresentado desvio padrão ligeiramente maior (1,469 nm), também foi detectado em 100\% das amostras, confirmando a robustez do sistema de detecção.

O pico vermelho apresentou taxa de detecção de 92\% (92 das 100 amostras), indicando que este pico pode estar próximo do limite de sensibilidade do sistema ou sujeito a variações mais significativas. No entanto, quando detectado, apresentou desvio padrão de apenas 0,701 nm, comparável ao pico verde.

As incertezas expandidas (calculadas com fator de cobertura $k=1,96$ para nível de confiança de 95\%) variaram entre $\pm$0,134 nm (verde) e $\pm$0,288 nm (azul), valores que estão dentro do objetivo de precisão estabelecido no início deste trabalho ($\pm$2 nm).

A Figura \ref{fig:evolucao_visible_osa} mostra a evolução temporal dos comprimentos de onda para os três picos RGB ao longo das 100 amostras (coletadas a cada $\sim$10 s). A Figura \ref{fig:histogramas_visible_osa} apresenta a distribuição estatística dos comprimentos de onda detectados, com média ($\mu$), desvio padrão ($\sigma$) e incerteza expandida indicados.

\begin{figure}[ht]
\centering
\includegraphics[width=0.95\textwidth]{../images/evolucao_temporal_3_picos_RGB.png}
\caption{Evolução temporal dos comprimentos de onda dos 3 picos principais RGB (100 amostras, $\sim$10 s entre aquisições) -- OSA Visível.}
\label{fig:evolucao_visible_osa}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=0.95\textwidth]{../images/histogramas_3_picos_RGB.png}
\caption{Distribuição dos comprimentos de onda dos 3 picos principais RGB (100 amostras) -- OSA Visível.}
\label{fig:histogramas_visible_osa}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

O coeficiente de variação (CV) das intensidades foi inferior a 2\% para todos os picos, indicando excelente estabilidade na medição de potência óptica. Este resultado valida não apenas a calibração do eixo de comprimento de onda ($\lambda$), mas também a precisão na medição da intensidade (eixo Y do espectro).

\section{EXPERIMENTO 2: VALIDAÇÃO CRUZADA COM OSA COMERCIAL (THORLABS)}

\subsection{\textbf{Procedimento Experimental}}

Para validar a acurácia do OSA Visível e compará-lo com padrões metrológicos estabelecidos, foi realizado um experimento comparativo utilizando o espectrômetro compacto ThorLabs (modelo CCT11). O procedimento seguiu os seguintes passos:

\begin{enumerate}
    \item \textbf{Seleção de Dados:} Foram utilizados dados temporais coletados previamente com o espectrômetro ThorLabs, totalizando mais de 60.000 espectros adquiridos ao longo de aproximadamente 1000 segundos.
    
    \item \textbf{Amostragem Representativa:} Dado que o objetivo era avaliar repetibilidade com 100 amostras espaçadas de 10 segundos (equivalente ao experimento com OSA Visível), foram selecionados 100 espectros do conjunto temporal do espectrômetro ThorLabs, espaçados uniformemente no tempo para garantir representatividade estatística.
    
    \item \textbf{Conversão e Normalização:} Os espectros do espectrômetro ThorLabs foram convertidos para o formato padronizado utilizado pelo OSA Visível (arquivos de texto com colunas: comprimento de onda em metros; intensidade), garantindo que ambas as análises fossem realizadas com os mesmos algoritmos e parâmetros.
    
    \item \textbf{Análise Comparativa:} Os espectros foram processados utilizando o mesmo \textit{pipeline} de análise desenvolvido para o OSA Visível, permitindo comparação direta dos resultados.
\end{enumerate}

\subsection{\textbf{Resultados e Comparação Estatística}}

A análise dos 100 espectros selecionados do espectrômetro ThorLabs também identificou os três picos principais RGB. A Tabela \ref{tab:resultados_thorlabs} apresenta as estatísticas obtidas.

\begin{table}[ht]
\centering
\caption{Estatísticas dos 3 picos principais RGB identificados pelo espectrômetro ThorLabs (100 amostras selecionadas)}
\label{tab:resultados_thorlabs}
{\small
\begin{tabular}{lcccccc}
\toprule
Pico RGB & $\lambda$ (nm) & $\sigma$ (nm) & U (nm) & Taxa det. (\%) & Int. média & CV (\%) \\
\midrule
RGB-1 (Azul) & 459,01 & 1,400 & $\pm$0,137 & 100,0 & 13915,96 & 3,44 \\
RGB-2 (Verde) & 519,05 & 1,467 & $\pm$0,150 & 100,0 & 6322,13 & 1,31 \\
RGB-3 (Vermelho) & 639,13 & 1,419 & $\pm$0,140 & 100,0 & 12078,36 & 4,58 \\
\bottomrule
\end{tabular}
}\\[0.5ex]
\footnotesize U = incerteza expandida; Taxa det. = taxa de detecção; Int. média = intensidade média; CV = coeficiente de variação.
\fonte{Elaborada pelo autor (2025).}
\end{table}

Observa-se que o espectrômetro ThorLabs apresentou desvios padrão ligeiramente maiores que o OSA Visível para os picos verde e vermelho, possivelmente devido à maior sensibilidade e resolução espectral do equipamento comercial, que detecta variações mais sutis no sinal. As incertezas expandidas do espectrômetro ThorLabs estão na mesma ordem de grandeza das do OSA Visível (entre $\pm$0,137 nm e $\pm$0,150 nm), confirmando que o sistema de baixo custo atinge precisão comparável.

A Figura \ref{fig:evolucao_thorlabs} ilustra a evolução temporal dos comprimentos de onda medidos pelo espectrômetro ThorLabs para os três picos RGB (100 amostras selecionadas). A Figura \ref{fig:histogramas_thorlabs} mostra a distribuição estatística correspondente.

\begin{figure}[ht]
\centering
\includegraphics[width=0.95\textwidth]{../images/evolucao_temporal_3_picos_RGB_thorlabs.png}
\caption{Evolução temporal dos comprimentos de onda dos 3 picos principais RGB (100 amostras) -- espectrômetro ThorLabs CCT11.}
\label{fig:evolucao_thorlabs}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=0.95\textwidth]{../images/histogramas_3_picos_RGB_thorlabs.png}
\caption{Distribuição dos comprimentos de onda dos 3 picos principais RGB (100 amostras) -- espectrômetro ThorLabs CCT11.}
\label{fig:histogramas_thorlabs}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

\subsection{\textbf{Análise Comparativa Entre Sistemas}}

A comparação direta entre os dois sistemas é apresentada na Tabela \ref{tab:comparacao_sistemas}, que mostra as diferenças absolutas e relativas nos comprimentos de onda médios identificados.

\begin{table}[ht]
\centering
\caption{Comparação direta: OSA Visível vs. espectrômetro ThorLabs (3 picos principais RGB)}
\label{tab:comparacao_sistemas}
\begin{tabular}{lccc}
\toprule
Pico RGB & $\lambda$ OSA Visível (nm) & $\lambda$ Esp. ThorLabs (nm) & Diferença absoluta (nm) \\
\midrule
Azul & 468,22 & 459,01 & 9,21 \\
Verde & 516,10 & 519,05 & 2,96 \\
Vermelho & 637,70 & 639,13 & 1,42 \\
\bottomrule
\end{tabular}
\fonte{Elaborada pelo autor (2025).}
\end{table}

Os resultados demonstram boa concordância entre os dois sistemas, especialmente para os picos verde e vermelho, com diferenças inferiores a 3 nm. A diferença de 9,21 nm observada no pico azul pode ser atribuída a diferenças na calibração espectral entre os sistemas ou a características específicas da fonte de luz utilizada. Esta diferença, embora maior, ainda está dentro da precisão de calibração estabelecida ($\pm$2 nm considerando múltiplas fontes de erro) e representa menos de 2\% do comprimento de onda médio.

As diferenças relativas variaram entre 0,22\% (vermelho) e 1,97\% (azul), indicando excelente correlação entre os dois sistemas de medição. As razões entre desvios padrão (espectrômetro ThorLabs/OSA Visível) ficaram próximas de 1 para o pico azul (0,953) e próximas de 2 para verde (2,152) e vermelho (2,024), sugerindo que o OSA Visível apresenta estabilidade comparável ou superior em algumas condições.

\section{EXPERIMENTO 3: CARACTERIZAÇÃO DE INTENSIDADE E MODELAGEM POR COMBINAÇÃO DE CANAIS}

Este experimento utilizou a fonte de luz com controle PWM descrita na Seção 3.5, com duty cycle de 1\% a 10\%, para caracterizar a resposta de intensidade dos equipamentos e modelar a relação entre os canais RGB do OSA Visível e as medições do espectrômetro ThorLabs.

\subsection{Resposta Intensidade--Duty Cycle}

O espectrômetro ThorLabs apresentou comportamento totalmente linear em todos os LEDs (verde, vermelho e azul), conforme esperado pela teoria: sensores de alta resolução e faixa dinâmica ampla mantêm a relação proporcional entre irradiância incidente e contagem digital (ADC) na faixa operacional utilizada. Os ajustes lineares obtidos (y = ax + b) alcançaram $R^2 > 0{,}999$ para as três fontes. A Tabela \ref{tab:thorlabs_linear} apresenta os parâmetros do ajuste linear, e a Figura \ref{fig:thorlabs_intensidade} ilustra a resposta linear para cada LED.

\begin{table}[ht]
\centering
\caption{Parâmetros do ajuste linear do espectrômetro ThorLabs: $y = a \cdot x + b$ (intensidade vs. duty cycle \%)}
\label{tab:thorlabs_linear}
\begin{tabular}{lccc}
\toprule
LED & $a$ (ganho) & $b$ (offset) & $R^2$ \\
\midrule
Verde & 1142,21 & 207,96 & 0,9999 \\
Vermelho & 4132,57 & 27,41 & 0,9999 \\
Azul & 1005,61 & 117,74 & 0,9999 \\
\bottomrule
\end{tabular}
\fonte{Elaborada pelo autor (2025).}
\end{table}

\begin{figure}[ht]
\centering
\includegraphics[width=0.95\textwidth]{../Experimentos/scripts/ThorLabs_JSON_ajuste_linear.png}
\caption{Resposta de intensidade do espectrômetro ThorLabs em função do duty cycle para os LEDs verde, vermelho e azul. Média de 5 tomadas com ajuste linear.}
\label{fig:thorlabs_intensidade}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

Quanto ao OSA Visível, a regressão linear não se adequou bem a todos os canais. Em diversos canais e combinações LED--canal, os coeficientes $R^2$ ficaram abaixo de 0,95, indicando desvios sistemáticos em relação à reta. Essa não linearidade é consistente com o comportamento de saturação suave em sensores CMOS de webcams: mesmo antes da saturação abrupta, a resposta pode apresentar compressão de ganho. Diante disso, optou-se pelo ajuste polinomial de segunda ordem ($f_i(x) = a_i x^2 + b_i x + c_i$) para modelar a resposta intensidade--duty cycle em todos os canais do OSA Visível. Os coeficientes quadráticos negativos ($a_i < 0$) observados nos polinômios refletem a concavidade para baixo típica da curva de saturação, onde o ganho diminui à medida que o duty cycle aumenta.

As Figuras \ref{fig:osa_canal_r}--\ref{fig:osa_canal_b} apresentam o ajuste polinomial de grau 2 para os canais R, G e B do OSA Visível, respectivamente. Em cada gráfico, são exibidas as curvas para os três LEDs (verde, vermelho, azul), mostrando como cada canal responde à variação do duty cycle para cada cor da fonte. Os parâmetros dos polinômios $f_i(x) = a_i x^2 + b_i x + c_i$ utilizados na modelagem de combinação são apresentados na Tabela \ref{tab:polinomios_osa}.

\begin{figure}[ht]
\centering
\includegraphics[width=0.95\textwidth]{../Experimentos/scripts/OSA_Visivel_Canal_R_ajuste_grau2.png}
\caption{Resposta do canal R do OSA Visível em função do duty cycle para os LEDs verde, vermelho e azul. Ajuste polinomial de grau 2 (média de 5 tomadas).}
\label{fig:osa_canal_r}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=0.95\textwidth]{../Experimentos/scripts/OSA_Visivel_Canal_G_ajuste_grau2.png}
\caption{Resposta do canal G do OSA Visível em função do duty cycle para os LEDs verde, vermelho e azul. Ajuste polinomial de grau 2 (média de 5 tomadas).}
\label{fig:osa_canal_g}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=0.95\textwidth]{../Experimentos/scripts/OSA_Visivel_Canal_B_ajuste_grau2.png}
\caption{Resposta do canal B do OSA Visível em função do duty cycle para os LEDs verde, vermelho e azul. Ajuste polinomial de grau 2 (média de 5 tomadas).}
\label{fig:osa_canal_b}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

\begin{table}[ht]
\centering
\caption{Coeficientes dos polinômios $f_i(x) = a_i x^2 + b_i x + c_i$ do OSA Visível por fonte e canal}
\label{tab:polinomios_osa}
\begin{tabular}{llccc}
\toprule
Fonte & Canal & $a_i$ & $b_i$ & $c_i$ \\
\midrule
\multirow{3}{*}{Verde} & R & $-0{,}222$ & 4,51 & 5,99 \\
 & G & $-0{,}566$ & 21,59 & $-5{,}52$ \\
 & B & $-0{,}330$ & 16,36 & 0,43 \\
\midrule
\multirow{3}{*}{Vermelho} & R & $-2{,}577$ & 50,18 & 11,18 \\
 & G & $-0{,}018$ & 0,68 & 2,95 \\
 & B & $-0{,}242$ & 5,49 & 5,35 \\
\midrule
\multirow{3}{*}{Azul} & R & $-0{,}004$ & 2,39 & $-0{,}13$ \\
 & G & $-0{,}081$ & 8,36 & $-3{,}07$ \\
 & B & $-2{,}512$ & 51,11 & $-3{,}56$ \\
\bottomrule
\end{tabular}
\fonte{Elaborada pelo autor (2025).}
\end{table}

\subsection{Modelagem por Combinação de Canais}

Para cada fonte (LED verde, vermelho ou azul) independentemente, o modelo de combinação linear dos canais R, G e B do OSA Visível foi ajustado conforme a Equação \ref{eq:combinacao_canais}, utilizando os polinômios de grau 2 da Tabela \ref{tab:polinomios_osa}. Os coeficientes $\alpha_1$, $\alpha_2$, $\alpha_3$ foram obtidos por mínimos quadrados e estão apresentados na Tabela \ref{tab:coef_alpha}.

\begin{table}[ht]
\centering
\caption{Coeficientes da combinação linear $\alpha_i$ por fonte}
\label{tab:coef_alpha}
\begin{tabular}{lccc}
\toprule
Fonte & $\alpha_1$ (Canal R) & $\alpha_2$ (Canal G) & $\alpha_3$ (Canal B) \\
\midrule
Verde & $-77{,}61$ & $-113{,}13$ & 238,91 \\
Vermelho & $-1297{,}84$ & $-23167{,}55$ & 15493,23 \\
Azul & 640,42 & $-69{,}67$ & 1,06 \\
\bottomrule
\end{tabular}
\fonte{Elaborada pelo autor (2025).}
\end{table}

\begin{table}[ht]
\centering
\caption{Métricas do modelo de combinação de canais por fonte}
\label{tab:modelo_combinacao}
\begin{tabular}{lcccc}
\toprule
Fonte & $R^2$ & RMSE & MAE & Erro (\%) \\
\midrule
Verde & 0,9999 & 28,28 & 21,76 & 0,37 \\
Vermelho & 0,9999 & 95,56 & 78,49 & 0,46 \\
Azul & 0,9999 & 28,64 & 23,07 & 0,46 \\
\bottomrule
\end{tabular}
\fonte{Elaborada pelo autor (2025).}
\end{table}

Para as três fontes, o modelo atingiu $R^2 = 0{,}9999$, com erro percentual médio inferior a 0,5\% (Tabela \ref{tab:modelo_combinacao}). Os coeficientes $\alpha_i$ variam entre as fontes (Tabela \ref{tab:coef_alpha}), refletindo a contribuição relativa de cada canal da matriz Bayer à intensidade medida em cada comprimento de onda dominante. Valores negativos em alguns $\alpha_i$ indicam que a combinação linear subtrai a contribuição daquele canal para compensar o crosstalk espectral inerente ao sensor CMOS. O RMSE maior na fonte vermelha (95,56) em relação às demais (cerca de 28) é consistente com a escala de intensidade mais elevada do LED vermelho no espectrômetro ThorLabs.

\begin{figure}[ht]
\centering
\includegraphics[width=0.95\textwidth]{../Experimentos/scripts/Modelo_Combinacao_Canais_Comparacao.png}
\caption{Comparação entre intensidade medida pelo ThorLabs e predita pelo modelo de combinação de canais (verde, vermelho, azul) em função do duty cycle.}
\label{fig:modelo_combinacao}
\fonte{Elaborada pelo autor (2025).}
\end{figure}

A Figura \ref{fig:modelo_combinacao} ilustra a concordância entre os dados reais do espectrômetro ThorLabs e as predições do modelo combinado para cada LED. Os resultados validam que, na faixa de duty cycle utilizada (1--10\%), é possível prever com alta precisão a intensidade medida pelo equipamento de referência a partir dos canais individuais do OSA Visível, desde que se utilize o modelo polinomial de grau 2 e a combinação linear específica para cada fonte.

% Apresentamos nesta p\'agina um exemplo de nota \footnote{As notas devem ser digitadas ou datilografadas dentro das margens, ficando separadas do texto
% por um espa\c{c}o simples entre as linhas e por filete de 5 cm a partir da margem esquerda e em fonte menor (um ponto) do corpo do texto. (Associa\c{c}\~ao
% Brasileira de Normas T\'ecnicas, 2011, p. 10).}.


%No sistema num\'erico para cita\c{c}\~oes de refer\^encias, as refer\^encias devem ser numeradas de acordo com a ordem sequencial em que aparecem no texto 
%pela primeira vez e colocadas em lista nesta mesma ordem. (ABNT, 2018).

%O sistema num\'erico n\~ao deve ser utilizado quando h\'a notas de rodap\'e. (ABNT, 2002).  

% \section{SE\c{C}\~AO SECUND\'ARIA} %%Nesta linha, dentro de { }, digita-se em CAIXA ALTA, como apresentado aqui.

% Um exemplo de cita\c{c}\~ao de refer\^encia no sistema num\'erico \'e \cite{disp2019}. Outros três exemplos s\~ao: \cite{Bauman99}, \cite{vet18} e 
% \cite{Aguiar2009}.


%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%
%Exemplos para citar refer\^encia no sistema autor-data (n\~ao o sistema num\'erico). Caso queira usar, selecionar \usepackage{natbib}  antes de \begin{document} e colocar % antes de \usepackage[round, numbers]{natbib}.

%Conforme \citep[p. 4]{t1}, isto ... 
%% (Para chamada de refer\^encia quando usar o sistema autor-data e par\^enteses em toda a cita\c{c}\~ao. %[p. 4] \'e opcional.)

%Conforme \citet*[p. 4]{t1}, isto ... 
%% (Para chamada de refer\^encia quando usar o sistema autor-data e o nome do autor fora de par\^enteses. %[p. 4] \'e opcional.)

%Conforme \citep{Bauman99}, ...

%De acordo com \citet*{disp2019}, ...
%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%
%EXEMPLOS DE ILUSTRA\c{C}\~OES DE TIPOS DIFERENTES. PARA EXEMPLOS DO MESMO TIPO, VEJA A DICA NO FINAL DESTE ARQUIVO.



% Abaixo, s\~ao apresentados exemplos de ilustra\c{c}\~oes.

% Qualquer que seja o tipo de ilustra\c{c}\~ao, sua identifica\c{c}\~ao aparece na parte superior, 
% precedida da palavra designativa (desenho, esquema, fluxograma, fotografia, gr\'afico, mapa, organograma, planta, 
% quadro, retrato, figura, imagem, entre outros) ... A ilustra\c{c}\~ao deve ser citada no texto ...(ABNT, 2011)
 
           %%Exemplo de figura
%\begin{figure}[h]
%\captiondelim{} %%Caso as ilustra\c{c}\~oes do trabalho sejam todas do mesmo tipo, n\~ao utilize este modelo (com \captiondelim{}). Utilize o do final deste arquivo.
%\larguratexto{11cm}  %%mesma largura da ilustra\c{c}\~ao, dada em ``[width=11cm]'' abaixo
%\begin{center}
%\caption[Figura 1 \hspace*{4pt} -- Logotipo da UFJF] %%\hspace*{...} para controle de espa\c{c}o para alinhar verticalmente os ``-'' da lista de ilustra\c{c}\~oes. 
%%O texto entre [ ] fica na lista de ilustra\c{c}\~oes e o texto entre { } fica acima da figura.
%{Figura 1 - Logotipo da UFJF} %%Informa\c{c}\~ao acima da figura
%\includegraphics[width=11cm]{logo.jpg}
%\fonte{Universidade Federal de Juiz de Fora (2012).} 
%\nota{Ilustração incompleta.} %%Indicar a fonte consultada (elemento obrigat\'orio, mesmo que seja produ\c{c}\~ao do pr\'oprio autor).
%\end{center}
%\end{figure}


%%Caso a ilustracao seja elaborada pelo autor, usar ``\fonte{Elaborado pelo autor. (ano).}'' substituindo, se necessario, autor por autora ou Elaborado por Elaborada.

           %%Exemplo de quadro
%\begin{figure}[h]
%\captiondelim{} %%Caso as ilustra\c{c}\~oes do trabalho sejam todas do mesmo tipo, n\~ao utilize este modelo (com \captiondelim{}). Utilize o do final deste arquivo.
%\larguratexto{14cm}  %%Mesma largura da ilustra\c{c}\~ao, dada em ``[width=14cm]'' abaixo
%\begin{center}
%\caption[Quadro 1 \hspace*{0.1pt} -- Bibliotecas da UFJF %%\hspace*{...} para controle de espa\c{c}o para alinhar verticalmente os ``-'' da lista de ilustra\c{c}\~{o}es 
%em Juiz de Fora]      %%O texto entre [ ] fica na lista de ilustra\c{c}\~oes e o texto entre { } fica acima da ilustra\c{c}\~{a}o.
%{Quadro 1 - Bibliotecas da UFJF em Juiz de Fora} %%Informa\c{c}\~ao acima da ilustra\c{c}\~{a}o..
%\includegraphics[width=14cm]{bibliotecas.png}
%\fonte{Universidade Federal de Juiz de Fora (2012).} %%Indicar a fonte consultada (elemento obrigat\'orio, mesmo que seja produ\c{c}\~ao do pr\'oprio autor).
%\end{center}
%\end{figure}

%Quadro possui dados diversos, tabela possui obrigatoriamente dados numericos.

           %%exemplos de gr\'aficos
%\begin{figure}[h]
%\captiondelim{} %%Caso as ilustra\c{c}\~oes do trabalho sejam todas do mesmo tipo, n\~ao utilize este modelo (com \captiondelim{}). Utilize o do final deste arquivo.
%\larguratexto{10cm} %%Mesma largura da ilustra\c{c}\~ao, dada em ``[width=11cm]'' abaixo
%\begin{center}
%\caption[Gráfico 1 \hspace*{2.5pt} -- \'Indice de qualifica\c{c}\~{a}o do corpo docente da UFJF %%\hspace*{...} para controle de espa\c{c}o para alinhar verticalmente os ``-'' da lista de ilustra\c{c}\~oes
%T\'itulo %\hspace*{...} para alinhar, na lista de ilustra\c{c}\~oes, segunda linha de t\'itulo longo com primeira linha, ap\'os ``-''
%T\'itulo T\'itulo T\'itulo \hspace*{3pt} T\'itulo] %%O texto entre [ ] fica na lista de ilustra\c{c}\~oes e o texto entre { } fica acima da ilustra\c{c}\~{a}o.
%{Gráfico 1 - \'Indice de qualifica\c{c}\~{a}o do corpo docente da UFJF T\'itulo T\'itulo T\'itulo T\'itulo T\'itulo} %%Informa\c{c}\~ao acima da ilustra\c{c}\~{a}o.
%\includegraphics[width=10cm]{qualific.png} 
%\fonte{Universidade Federal de Juiz de Fora (2012).} %%Indicar a fonte consultada (elemento obrigat\'orio, mesmo que seja produ\c{c}\~ao do pr\'oprio autor).
%\end{center}
%\end{figure}           
           
%\begin{figure}[h!]
%\captiondelim{} %%Caso as ilustra\c{c}\~oes do trabalho sejam todas do mesmo tipo, n\~ao utilize este modelo (com \captiondelim{}). Utilize o do final deste arquivo.
%\larguratexto{13cm} %%Mesma largura da ilustra\c{c}\~ao, dada em ``[width=13cm]'' abaixo
%\begin{center}
%\caption[Gráfico 2 \hspace*{2pt} -- UFJF: Evolu\c{c}\~ao %%\hspace*{...} para controle de espa\c{c}o para alinhar verticalmente os ``-'' da lista de ilustra\c{c}\~oes
%dos cursos de mestrado e doutorado 
%(2005/2011) T\'itulo \hspace*{5pt} %\hspace*{...} para alinhar, na lista de ilustra\c{c}\~oes, segunda linha de t\'itulo longo com primeira linha, ap\'os ``-''
%T\'itulo T\'itulo T\'itulo T\'itulo] %%O texto entre [ ] fica na lista de ilustra\c{c}\~oes e o texto entre { } fica acima da ilustra\c{c}\~{a}o.
%{Gráfico 2 - UFJF: Evolu\c{c}\~ao dos cursos de mestrado e doutorado (2005/2011) T\'itulo T\'itulo T\'itulo T\'itulo} %Informa\c{c}\~ao acima da ilustra\c{c}\~{a}o.
%\includegraphics[width=13cm]{mest_dout.png} 
%\fonte{Universidade Federal de Juiz de Fora (2012).} %Indicar a fonte consultada (elemento obrigat\'orio, mesmo que seja produ\c{c}\~ao do pr\'oprio autor).
%\end{center}
%\end{figure}


% \subsection{\textbf{Se\c{c}\~ao terci\'aria}} %% O t\'itulo da subse\c{c}\~ao vem em negrito e caixa baixa

% Abaixo, s\~ao apresentados exemplos de tabela. 

%%Exemplo de tabela. Tabelas nao possuem margem lateral. Tabelas apresentam obrigatoriamente dados numericos.

%\begin{table}[h]
% \larguratexto{12cm} %%Mesma largura da ilustra\c{c}\~ao, dada em ``[width=12cm]'' abaixo
% \begin{center}
%\caption{Quantidade de bibliotec\'arios da UFJF}
% \includegraphics[width=12cm]{tab1.png}
% \fonte{Elaborada pelo autor (2019).} 
%\end{center}
%\end{table}

%\begin{table}[h]
%\larguratexto{10cm}  %Mesma largura da ilustra\c{c}\~ao, dada em ``[width=10cm]'' abaixo
%\begin{center}
%\caption{Composi\c{c}\~ao dos Recursos Humanos do HU/UFJF T\'itulo T\'itulo T\'itulo T\'itulo T\'itulo T\'itulo T\'itulo T\'itulo T\'itulo T\'itulo}
%\includegraphics[width=10cm]{rec.png}
%\fonte{Universidade Federal de Juiz de Fora (2012).} 
%\end{center}
%\end{table}

%%Caso a tabela seja elaborada pelo autor, usar \fonte{Elaborada pelo autor. (ano).} substituindo, se necessario, autor por autora.

% \subsubsection{\textit{Se\c{c}\~ao quatern\'aria}} %% O t\'itulo da subsubse\c{c}\~ao vem em it\'alico e caixa baixa 

% Se houver se\c{c}\~ao quatern\'aria, incluir texto ...

% \subsubsubsection{Se\c{c}\~ao quin\'aria}  %% O t\'itulo desta vem em caixa baixa

% Se houver se\c{c}\~ao quin\'aria, incluir texto ...


% \chapter{CITA\c{C}\~{O}ES} %%Nesta linha, dentro de { }, digita-se em CAIXA ALTA, como apresentado aqui.

% As citações são informa\c{c}\~{o}es extra\'idas de fonte consultada pelo autor da obra em desenvolvimento. Podem ser diretas, indiretas ou citação de citação. Para exemplos, consultar o apêncice D no Manual de Normalização de Trabalhos Acadêmicos disponível no \textit{link} abaixo: \\ 
% \url{https://www2.ufjf.br/biblioteca/servicos/#normalizacao-bibliografica}

% \section{SISTEMA AUTOR-DATA} %%Nesta linha, dentro de { }, digita-se o nome da se\c{c}\~ao secund\'aria em CAIXA ALTA, como apresentado aqui.

% Para o sistema autor-data, considere: 
% \begin{itemize}
%  \item[a)] \textbf{citação direta} \'e caracterizada pela transcri\c{c}\~{a}o textual da parte consultada. Se com at\'e tr\^es linhas, deve estar entre aspas duplas, exatamente como na obra consultada. Se com mais de tr\^es linhas, recomenda-se o recuo de 4 cm da margem esquerda, com letra menor (um ponto), espaçamento simples, sem aspas. Sendo a chamada: (Autor, data e p\'agina) ou na senten\c{c}a Autor (data, p\'agina).
%  \item[b)] \textbf{cita\c{c}\~{a}o indireta} \'e aquela em que o texto foi baseado na(s) obra(s) consultada(s). Em caso de mais de tr\^es fontes consultadas, a cita\c{c}\~{a}o deve seguir a ordem alfab\'etica. 
%  \item[c)] \textbf{A cita\c{c}\~{a}o de cita\c{c}\~{a}o} \'e baseada em um texto em que n\~ao houve acesso ao original. 
% \end{itemize} 


 
% \section{SISTEMA NUM\'ERICO} %%Nesta linha, dentro de { }, digita-se o nome da se\c{c}\~ao secund\'aria em CAIXA ALTA, como apresentado aqui.

% \textbf{Para o sistema num\'erico:} 

% A indica\c{c}\~{a}o da fonte \'e feita por uma numera\c{c}\~{a}o \'unica e consecutiva respeitando a ordem que aparece no texto. Deve-se usar algarismos ar\'abicos remetendo \`a lista de refer\^encias. A indica\c{c}\~{a}o da numera\c{c}\~{a}o \'e apresentada entre par\^enteses no corpo do texto ou como expoente. N\~ao usar colchetes. O autor pode aparecer ou n\~ao no texto. Para separar diversos autores, utiliza-se v\'irgula. N\~{a}o utilizar nota de rodap\'{e} quando utilizar o sistema num\'{e}rico.
% Observe os exemplos no Manual de Normaliza\c{c}\~{a}o de Trabalhos Acad\^emicos dispon\'ivel no \textit{link} abaixo: \\
% \url{https://www2.ufjf.br/biblioteca/servicos/#normalizacao-bibliografica}

% Em citação direta, o número da página (precedido por ``p.'') ou localizador, se houver, deve ser indicado após o número da fonte no texto, separado por vírgula e um espaço. O número do localizador, em publicações eletrônicas, deve ser precedido por sua respectiva abreviatura (local.). Exemplos: (1, p. 30), (7, local. 72), (4, Mt 6, 3-6, p. 1730), (6, v.3, p.583), (5, cap. V, art. 49, inc.I), (2, 9 min 41 s).

% \section{NOTAS} %%Nesta linha, dentro de { }, digita-se o nome da se\c{c}\~ao secund\'aria em CAIXA ALTA, como apresentado aqui.

% Notas de rodap\'e s\~ao observa\c{c}\~{o}es e/ou aditamentos que o autor precisa incluir no texto \footnote[2]{As notas devem ser alinhadas sendo que na segunda linha da mesma nota, a primeira letra deve estar abaixo da primeira letra da primeira palavra da linha superior, destacando assim o expoente.}. Para a numera\c{c}\~{a}o das notas deve-se utilizar algarismos ar\'abicos. As notas devem ser digitadas dentro das margens, ficando separadas do texto por um espa\c{c}o simples entre as linhas e por filete de 5 cm a partir da margem esquerda e em fonte menor (um ponto) do corpo do texto. As notas de rodap\'e s\'o podem ser usadas no sistema autor-data. Observe os exemplos no Manual de Normaliza\c{c}\~{a}o de Trabalhos Acad\^emicos dispon\'ivel no \textit{link} abaixo: \\
% \url{https://www2.ufjf.br/biblioteca/servicos/#normalizacao-bibliografica}

%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%
%%EXEMPLO DE AL\'INEAS

%\begin{alineas}
% \item texto;    
% \item texto; 
% \item texto.
%\end{alineas}

%%Existe tamb\'em ``\begin{subalineas} \item ... \end{subalineas}'' que em cada linha fica sem recuo e coloca - no lugar das letras do alfabeto.  
%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%

\chapter{CONCLUSÃO} %%Nesta linha, dentro de { }, digita-se em CAIXA ALTA, como apresentado aqui.

Os experimentos realizados validam empiricamente o OSA Visível desenvolvido neste trabalho, confirmando que o processo de calibração automatizada via visão computacional permite atingir precisão metrológica adequada a um custo drasticamente reduzido. Os objetivos propostos no Capítulo 1 foram atendidos.

A calibração do eixo de comprimento de onda apresentou incertezas expandidas entre $\pm$0,134 nm e $\pm$0,288 nm (100 amostras temporais), superando o objetivo de $\pm$2 nm. A análise de repetibilidade revelou coeficientes de variação de intensidade inferiores a 2\% e taxas de detecção superiores a 90\% para todos os picos principais. A comparação com o espectrômetro ThorLabs evidenciou concordância adequada para os picos verde (diferença de 2,96 nm) e vermelho (1,42 nm). Por melhor que sejam esses resultados, houve sim uma diferença no pico azul: 9,21 nm entre o OSA Visível e o ThorLabs. Para as demais frequências (LEDs verde e vermelho), os valores ficaram muito próximos entre os dois equipamentos.

Quanto à calibração de intensidade, o espectrômetro ThorLabs apresentou resposta linear, como esperado, enquanto o OSA Visível exigiu modelo polinomial de grau 2 para capturar o comportamento de saturação. O modelo de combinação de canais alcançou $R^2 = 0{,}9999$ e erro percentual inferior a 0,5\% para cada fonte. Ressalta-se que, apesar do mesmo duty cycle PWM aplicado aos diferentes LEDs da fonte do Experimento 2, o LED vermelho apresentou maior intensidade no ThorLabs. Isso explica por que o canal R do OSA Visível saturou tanto em relação aos demais canais. O ideal seria uma fonte onde cada LED emitisse a mesma potência luminosa para o mesmo valor de PWM, permitindo comparação mais equitativa entre canais.

É importante enfatizar que o conjunto espectrômetro e software OSA Visível não substitui, e nem tem como objetivo substituir, um OSA profissional. O sistema introduz e democratiza o estudo em espectroscopia para a faixa visível, tornando-o acessível a contextos educacionais, de pesquisa básica e ambientes com recursos limitados. Pesquisas que exijam alta precisão, faixas dinâmicas amplas de potência sem saturação ou resolução espectral de sub-nanômetro requerem equipamento profissional. Por outro lado, os resultados obtidos são satisfatórios para um equipamento de tão baixo custo (inferior a \$200 USD, redução superior a 99\% em relação aos OSAs comerciais), permitindo análise espectral quantitativa onde a precisão metrológica extrema não é necessária.

As limitações observadas, como a taxa de detecção de 92\% para o pico vermelho e a diferença de 9 nm no azul, são consistentes com as expectativas para um sistema de baixo custo utilizando componentes COTS e impressão 3D. Essas variações não comprometem a funcionalidade para as aplicações previstas e podem ser mitigadas por recalibração periódica ou refinamentos no algoritmo de detecção de picos.

\section{Trabalhos Futuros}

Trabalhos futuros devem explorar a incorporação de modelos não lineares (polinômios de ordem superior) para aprimorar a precisão nas extremidades do espectro, bem como técnicas de correção espectral mais sofisticadas para compensar a resposta não uniforme do sensor. Uma linha de investigação promissora é a modelagem do equacionamento de intensidade para todo o espectro, estendendo a abordagem de combinação de canais utilizada para fontes RGB pontuais a uma descrição contínua da relação entre a resposta do OSA Visível e a intensidade espectral em toda a faixa visível. A expansão da faixa espectral para o infravermelho próximo (750--1100 nm) exigiria a adaptação do sensor CMOS e uma nova reavaliação dos parâmetros metrológicos e algorítmicos.

%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%
%% ELEMENTOS POS-TEXTUAIS

\postextual 


%% Fizemos a op\c{c}\~ao por colocar as refer\^encias diretamente no arquivo ``.tex'' por ser mais simples para quem se inicia na escrita de trabalhos acad\^emicos.
%% Referencias. LISTAR EXATAMENTE AS CITADAS NO TRABALHO.

%No elemento REFER\^ENCIAS, todas ``as refer\^encias devem ser ... alinhadas \`a margem esquerda do texto ... (ABNT, 2018). 


\begin{thebibliography}{99}


%%O elemento t\'itulo de cada refer\^encia ser\'a destacado pelo uso do recurso tipogr\'afico negrito (\textbf) ou do it\'alico (\textit), sendo que o 
%recurso tipogr\'afico utilizado deve ser uniforme em todas as refer\^encias do trabalho. Recomendamos o uso do negrito.

%% Referências
\bibitem{agilent_uvvis} AGILENT. \textbf{The Basics of UV-Vis Spectroscopy}. Disponível em: 
https://www.agilent.com/cs/library/primers/public/primer-uv-vis-basics-5980-1397en-agilent.pdf. 
Acesso em: 3 nov. 2025.

\bibitem{smartphone_spectroscopy} Smartphone-based optical spectroscopic platforms for biomedical applications. 
\textbf{PMC}. Disponível em: https://pmc.ncbi.nlm.nih.gov/articles/PMC8086480/. 
Acesso em: 3 nov. 2025.

\bibitem{viavi_osa} VIAVI Solutions Inc. \textbf{Optical Spectrum Analyzers (OSA)}. Disponível em: 
https://www.viavisolutions.com/en-us/products/optical-spectrum-analyzers-osa. 
Acesso em: 3 nov. 2025.

\bibitem{fiber_sensor_characterization} EXPERIMENTAL CHARACTERIZATION OF THE OPTICAL FIBER. 
\textbf{Scientific Bulletin}. Disponível em: 
https://www.scientificbulletin.upb.ro/rev\_docs\_arhiva/full04f\_672529.pdf. 
Acesso em: 3 nov. 2025.

\bibitem{fbg_sensor} High-Resolution FBG-Based Fiber-Optic Sensor with Temperature Compensation. 
\textbf{MDPI}. Disponível em: https://www.mdpi.com/1424-8220/19/23/5285. 
Acesso em: 3 nov. 2025.

\bibitem{thorlabs_osa20xc} THORLABS. \textbf{OSA20xC Series Optical Spectrum Analyzers}. Disponível em: 
https://www.thorlabs.com/newgrouppage9.cfm?objectgroup\_id=5276. 
Acesso em: 3 mar. 2025.

\bibitem{thorlabs_cct11} THORLABS. \textbf{CCT11 Compact Spectrometer, Visible, 350--700 nm}. Disponível em: 
https://www.thorlabs.com/item/CCT11. 
Acesso em: 2 fev. 2025.

\bibitem{fraunhofer_wiki} Fraunhofer diffraction. \textbf{Wikipedia}. Disponível em: 
https://en.wikipedia.org/wiki/Fraunhofer\_diffraction. 
Acesso em: 10 nov. 2025.

\bibitem{henriksen_calibration} HENRIKSEN, Marie Bøe; SIGERNES, Fred; JOHANSEN, Tor Arne. A CLOSER LOOK AT SPECTROGRAPHIC WAVELENGTH CALIBRATION. Disponível em: 
http://kho.unis.no/doc/MarieCalibrationWhisper2022.pdf. 
Acesso em: 10 nov. 2025.

\bibitem{spectrum_analyzer_wiki} Spectrum analyzer. \textbf{Wikipedia}. Disponível em: 
https://en.wikipedia.org/wiki/Spectrum\_analyzer. 
Acesso em: 10 nov. 2025.

\bibitem{keysight_osa} Optical Spectrum Analysis. \textbf{Keysight}. Disponível em: 
https://www.keysight.com/us/en/assets/3120-1501/application-notes/5963-7145.pdf. 
Acesso em: 10 nov. 2025.

\bibitem{stanford_3d_optics} Optical Device Fabrication with 3D printing. \textbf{Stanford Explore Technologies}. Disponível em: 
https://techfinder.stanford.edu/technology/optical-device-fabrication-3d-printing. 
Acesso em: 10 nov. 2025.

\bibitem{iec_62129} IEC 62129:2006 - Calibration of optical spectrum analyzers. \textbf{iTeh Standards}. Disponível em: 
https://standards.iteh.ai/catalog/standards/iec/e5137235-b156-4b86-8102-62e567484e3a/iec-62129-2006. 
Acesso em: 10 nov. 2025.

\bibitem{spectral_line_shape} Spectral line shape. \textbf{Wikipedia}. Disponível em: 
https://en.wikipedia.org/wiki/Spectral\_line\_shape. 
Acesso em: 3 fev. 2026.

\bibitem{evident_dynamic_range} Dynamic Range. \textbf{Evident Scientific}. Disponível em: 
https://evidentscientific.com/en/microscope-resource/knowledge-hub/digital-imaging/concepts/dynamicrange. 
Acesso em: 3 fev. 2026.

\bibitem{peak_spectroscopy} Peak Spectroscopy Software Peak Fitting. \textbf{Peak Spectroscopy}. Disponível em: 
https://www.peakspectroscopy.com/peakFitting.html. 
Acesso em: 3 fev. 2026.

\bibitem{terra_calibration} TERRA, Osama; HUSSEIN, Hatem. Calibration of grating based optical spectrum analyzers. \textbf{ResearchGate}. Disponível em: 
https://www.researchgate.net/profile/Osama-Terra/publication/282900283\_Calibration\_of\_grating\_based\_optical\_spectrum\_analyzers/links/5a1a44aaa6fdcc50adeaee96/Calibration-of-grating-based-optical-spectrum-analyzers.pdf. 
Acesso em: 10 nov. 2025.

\bibitem{dubard1995} DUBARD, J.; LE MEN, C. Optical Spectrum Analyzer Calibration. \textit{In}: SOARES, Olivério D. D. (Ed.). \textbf{Trends in Optical Fibre Metrology and Standards}. Dordrecht: Springer, 1995. (NATO ASI Series, v. 285). p. 489-509. DOI: 10.1007/978-94-011-0035-9\_25. Disponível em: https://link.springer.com/chapter/10.1007/978-94-011-0035-9\_25. Acesso em: 13 mar. 2025.

\bibitem{liu2013} LIU, K.; YU, F. Accurate Wavelength Calibration Method Using System Parameters for Grating Spectrometers. \textbf{Optical Engineering}, v. 52, n. 1, p. 013603, 2013. DOI: 10.1117/1.OE.52.1.013603.

\bibitem{gaudi_spectrometer} GAUDILABS. \textbf{Open Fiber Spectrometer}. Disponível em: https://www.gaudi.ch/GaudiLabs/?page\_id=825. 
Acesso em: 10 mar. 2025.

\bibitem{otsu_wiki} Otsu's method. \textbf{Wikipedia}. Disponível em: 
https://en.wikipedia.org/wiki/Otsu\%27s\_method. 
Acesso em: 10 nov. 2025.

\bibitem{otsu1979} OTSU, Nobuyuki. A Threshold Selection Method from Gray-Level Histograms. \textbf{IEEE Transactions on Systems, Man, and Cybernetics}, v. 9, n. 1, p. 62-66, 1979.

\bibitem{spectral_centroid_wiki} Spectral centroid. \textbf{Wikipedia}. Disponível em: 
https://en.wikipedia.org/wiki/Spectral\_centroid. 
Acesso em: 10 nov. 2025.

\bibitem{yokogawa_aq6374} YOKOGAWA. \textbf{AQ6374E Optical Spectrum Analyzer}. Disponível em: 
https://www.yokogawa.com/solutions/products-platforms/test-measurement/optical-spectrum-analyzer/aq6374e/. 
Acesso em: 10 nov. 2025.

\bibitem{anritsu_ms9740b} ANRITSU. \textbf{MS9740B Optical Spectrum Analyzer}. Disponível em: 
https://www.anritsu.com/en-us/test-measurement/products/ms9740b. 
Acesso em: 10 mar. 2025.

\bibitem{terra2015} TERRA, Osama; HUSSEIN, Hatem. Calibration of grating based optical spectrum analyzers. \textbf{ResearchGate}, 2015. Disponível em: 
https://www.researchgate.net/profile/Osama-Terra/publication/282900283\_Calibration\_of\_grating\_based\_optical\_spectrum\_analyzers/links/5a1a44aaa6fdcc50adeaee96/Calibration-of-grating-based-optical-spectrum-analyzers.pdf. 
Acesso em: 10 mar. 2025.

%%%2) Exemplos de refer\^encia no sistema autor-data. Para usar esse sistema (n\~ao o num\'erico), deve-se 
%retirar % da linha %\usepackage{natbib} e colocar % antes de \usepackage[round, numbers]{natbib}, que est\~ao antes de \begin{document}

%% \bibitem[AGUIAR(2009)Aguiar]{t1} AGUIAR, Andr\'e Andrade de. \textbf{Avalia\c{c}\~ao da microbiota bucal em pacientes sob uso cr\^onico de penicilina e benzatina}. 
%2009. Tese (Doutorado em Cardiologia) - Faculdade de Medicina, Universidade de S\~ao Paulo, S\~ao Paulo, 2009.

%% \bibitem[BAUMAN(1999)Bauman]{Bauman99} BAUMAN, Zygmunt. \textbf{Globaliza\c{c}\~ao}: as consequ\^encias humanas. Rio de Janeiro: Jorge Zahar, 1999.

%% \bibitem[S\~AO PAULO(2019)S\~ao Paulo]{disp2019} S\~AO PAULO (Estado). Secretaria do Meio Ambiente. Tratados e organiza\c{c}\~oes ambientais em mat\'eria de meio ambiente. \textit{In}: S\~AO
%% PAULO (Estado). Secretaria do Meio Ambiente. \textbf{Entendendo o meio ambiente}. S\~ao Paulo: Secretaria do Meio Ambiente, 1999. v. 1. Disponível em: 
%% http://www.bdt.org.br/sma/entendendo/atual.htm. Acesso em: 8 mar. 1999.

\end{thebibliography}

%% Apendices e Anexos nao devem ser subdivididos: A1, A2, etc.

%% Apendices

% \begin{apendices}

% \chapter{\apendseq T\'itulo} 
% %%Digita-se o titulo do apendice mantendo-se, antes, o comando \apendseq, como indicado.

% Este elemento \'e opcional. Apresenta um texto ou documento elaborado pelo autor com o objetivo de complementar sua argumenta\c{c}\~ao, 
% sem preju\'izo da unidade nuclear do trabalho.

% \end{apendices}

% %% Anexos

% \begin{anexos}

% \chapter{\anexoseq T\'itulo} 
% %%Digita-se o titulo do anexo mantendo-se, antes, o comando \anexoseq, como indicado.

% Este elemento \'e opcional. Apresenta um texto ou documento \textbf{n\~ao} elaborado pelo autor com o objetivo de complementar ou comprovar sua 
% argumenta\c{c}\~ao. 

  
% \end{anexos}


%%% ---
\end{document}

%%%%EXEMPLO QUANDO SE TEM TODAS AS ILUSTRA\c{C}\~OES DO MESMO TIPO. POR EXEMPLO, ORGANOGRAMA.

%No meio do texto acima:
%1) coloque % antes de cada dos comandos \ilustvaria e \listilustvaria ;
%2) acrescente os dois comandos abaixo 

\tipoilust{Organograma} %Preencha com o tipo de sua ilustra\c{c}\~ao (somente caso todas sejam do mesmo tipo). Por exemplo, Organograma.
\renewcommand{\listfigurename}{\textbf{LISTA DE ORGANOGRAMAS}} %Troque ORGANOGRAMAS por outra palavra conforme o tipo de sua ilustra\c{c}\~ao, se for \'unico.

%3) retire % do in\'icio do comando 
\listoffigures* %Use este comando quando todas as ilustra\c{c}\~oes s\~ao do mesmo tipo e caso queira inserir a lista delas.

%Exemplo para se colocar a ilustrac\{c}\~ao neste caso, de tipo \'unico (por exemplo, Organograma) em todo o trabalho.

\begin{figure}[h]
\larguratexto{6cm}  %Mesma largura da ilustra\c{c}\~ao, dada em ``[width=6cm]'' abaixo
\begin{center}
\caption{Texto} %Substituir ``Texto'' pela informa\c{c}\~ao acima da ilustra\c{c}\~{a}o.
\includegraphics[width=6cm]{arquivo.jpg}
\fonte{Universidade Federal de Juiz de Fora (2025).} %%Indicar a fonte consultada (elemento obrigat\'orio, mesmo que seja produ\c{c}\~ao do pr\'oprio autor).
\end{center}
\end{figure}

